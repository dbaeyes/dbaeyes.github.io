<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在遙遠的地方 一切虔誠終必相遇">

    <title>Aria2——Unix 系统中潜行的下载神器 - Microdust</title>

    <link rel="canonical" href="http://azeril.me/blog/Aria2.html">

    <!-- Icons -->
  <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Microdust</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/About.html">About</a>
                </li>
                
                <li>
                    <a href="/Lists.html">Reading</a>
                </li>
                
                <li>
                    <a href="/Tools.html">Tools</a>
                </li>
                
                <li>
                    <a href="/tags.html">Tags</a>
                </li>
                
                <li>
                    <a href="/photos/Instagram/">Photos: Instagram</a>
                </li>
                
                <li>
                    <a href="/photos/">Photos</a>
                </li>
                

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/fantasy.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="Tags">
                        
                        <a class="tag" href="/Tags/#Tool" title="Tool">Tool</a>
                        
                        <a class="tag" href="/Tags/#Mac" title="Mac">Mac</a>
                        
                    </div>
                    <h1>Aria2——Unix 系统中潜行的下载神器</h1>
                    
                    <span class="meta">Posted by Azeril on January 24, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container">

                <p>拥有了 Aria2 的默默扶持，再也不用待见不用忍受 OSX 下国内那些半死不活的下载工具了。</p>

<h2 id="aria2">关于 Aria2</h2>

<p><a href="https://aria2.github.io/">Aria2</a> 是一个基于命令行的开源下载工具，支持多协议、多来源（Http/https、FTP、Magnet、BitTorrent 等）、多线程的下载。</p>

<p>主要优势如下：</p>

<ul>
  <li>高速，自动多线程下载；</li>
  <li>断点续传；</li>
  <li>轻量。占用内存非常少，通常情况平均 4~9MB 内存占用（官方介绍）；</li>
  <li>多平台。支援 Win/Linux/OSX/Android 等操作系统下的部署；</li>
  <li>模块化。分段下载引擎，文件整合速度快；</li>
  <li>支持 RPC 界面远程；</li>
  <li>全面支持 BitTorrent 协议；</li>
</ul>

<h2 id="install-aria2">Install Aria2</h2>

<p>安装 Aria2 依赖于 Mac 下的包管理工具 Homebrew（Linux 用户可使用 apt-get 命令直接安装）。而 Homebrew 的使用依赖于 OSX 的 XCode 命令行工具部分。所以，这些都得有…（Linux 用户直接看第 2 小节）。</p>

<ol>
  <li>先安装 Homebrew:
    <ul>
      <li>打开终端（Terminal or iTerm）</li>
      <li>安装 XCode(已安装可跳过，选装 XCode 的 CLI 工具)：<code class="highlighter-rouge">$ xcode-select --install</code></li>
      <li>复制并运行 Homebrew 安装命令：<code class="highlighter-rouge">$ ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</code></li>
      <li>查看版本（确认安装是否完成）:<code class="highlighter-rouge">$ brew --version</code> </li>
    </ul>
  </li>
  <li>Homebrew 管理工具加入系统后，安装 Aria2：
    <ul>
      <li>OSX 运行：<code class="highlighter-rouge">$ brew install aria2</code></li>
      <li>Linux 运行: <code class="highlighter-rouge">$ sudo apt-get install aria2</code> </li>
    </ul>
  </li>
  <li>查看命令安装情况：
    <ul>
      <li><code class="highlighter-rouge">$ aria2c --version</code> 提示版本及说明则表示已安装完成。</li>
    </ul>
  </li>
</ol>

<h2 id="aria2-1">配置 Aria2</h2>

<p>命令安装完，进入 Aria2 的配置部分。</p>

<ol>
  <li>在系统主目录下新建 <code class="highlighter-rouge">.aria2</code> 文件夹。
    <ul>
      <li><code class="highlighter-rouge">$ mkdir .aria2</code></li>
    </ul>
  </li>
  <li>在 .aria2 文件夹下新建 <code class="highlighter-rouge">aria2.conf</code> 配置文件。
    <ul>
      <li>进入文件夹：<code class="highlighter-rouge">$ cd .aria2</code></li>
      <li>创建配置文件：<code class="highlighter-rouge">$ touch aria2.conf</code></li>
    </ul>
  </li>
  <li>在 Finder 里查看并对文件进行编辑。
    <ul>
      <li>a. iTerm/Terminal 当前路径下(<code class="highlighter-rouge">~/.aria2/</code>)输入命令 <code class="highlighter-rouge">$ open .</code> 进入 Finder 界面下 .aria2 文件夹；</li>
      <li>b. Finder 界面，快捷键 Command + Shift + G 在弹出的路径跳转小窗口，填入 <code class="highlighter-rouge">~/.aria2/aria2.conf</code> 后 Return。</li>
    </ul>
  </li>
  <li>使用 TextMate/Sublime Text/TextEdit 等编辑器打开 aria2.conf 文档，填入内容。</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code>#用户名
#rpc-user=user
#密码
#rpc-passwd=passwd
#上面的认证方式不建议使用,建议使用下面的token方式
#设置加密的密钥
#rpc-secret=token
#允许rpc
enable-rpc=true
#允许所有来源, web界面跨域权限需要
rpc-allow-origin-all=true
#允许外部访问，false的话只监听本地端口
rpc-listen-all=true
#RPC端口, 仅当默认端口被占用时修改
rpc-listen-port=6800
#最大同时下载数(任务数), 路由建议值: 3
max-concurrent-downloads=5
#断点续传
continue=true
#同服务器连接数
max-connection-per-server=5
#最小文件分片大小, 下载线程数上限取决于能分出多少片, 对于小文件重要
min-split-size=10M
#单文件最大线程数, 路由建议值: 5
split=10
#下载速度限制
max-overall-download-limit=0
#单文件速度限制
max-download-limit=0
#上传速度限制
max-overall-upload-limit=0
#单文件速度限制
max-upload-limit=0
#断开速度过慢的连接
#lowest-speed-limit=0
#验证用，需要1.16.1之后的release版本
#referer=*
#文件保存路径, 默认为当前启动位置
dir=/Users/YourID/Downloads
#文件缓存, 使用内置的文件缓存, 如果你不相信Linux内核文件缓存和磁盘内置缓存时使用, 需要1.16及以上版本
#disk-cache=0
#另一种Linux文件缓存方式, 使用前确保您使用的内核支持此选项, 需要1.15及以上版本(?)
#enable-mmap=true
#文件预分配, 能有效降低文件碎片, 提高磁盘性能. 缺点是预分配时间较长
#所需时间 none &lt; falloc ? trunc &lt;&lt; prealloc, falloc和trunc需要文件系统和内核支持
file-allocation=prealloc
</code></pre>
</div>

<p>注意将配置表中保存路径一项「YourMacID」替换为个人的 Mac OSX 用户名（不知道可以用 <code class="highlighter-rouge">$ pwd</code> 命令查看）。</p>

<p>保存并退出。</p>

<h2 id="aria2-">Aria2 的使用</h2>

<p>配置完成后，就可以开始使用了。</p>

<p>Aria2 有两种模式：</p>

<ul>
  <li>命令直接调用。调用命令 <code class="highlighter-rouge">$ aria2c "download.url"</code> 下载完成后退出</li>
  <li>后台常驻触发，也就是 rpc server 模式。Aria2 作为后台常驻程序，监测 rpc 端口的活动情况，添加并下载文件。完成后继续在后台运行。</li>
</ul>

<p>涉及到命令输入，力求简化，第二种模式明显更省事。</p>

<p>启动 Aria2 rpc 模式的命令：</p>

<p><code class="highlighter-rouge">$ aria2c --conf-path=&lt;Path&gt;</code></p>

<p><code class="highlighter-rouge">&lt;Path&gt;</code> 是指配置文件所在的绝对路径。依照上述配置一路下来，具体是：</p>

<p><code class="highlighter-rouge">$ aria2c --conf-path="/Users/YourMacID/.aria2/aria2.conf" -D</code></p>

<p>使用时注意将其中的「YourMacID」替换为个人的 Mac OSX 用户名。</p>

<p>这时，正确无误的话，Aria2 就启动了。</p>

<p>安装扩展程序，方便浏览器中查看和下载资源时的 rpc 端口调用。</p>

<p><a href="https://chrome.google.com/webstore/detail/baiduexporter/mjaenbjdjmgolhoafkohbhhbaiedbkno/related">BaiduExporter - Chrome 网上应用店</a> 主要用于 Mac 下下载百度云的资源。</p>

<p>在网站内可见一个「导出下载」的按钮。点击可见 RPC 导出下载和设置三个选项。下载点击 RPC 选项即可。</p>

<p>界面：</p>

<p><img src="http://dreamofbook.qiniudn.com/Aria2DownloadClick.png" alt="" /></p>

<p>如果点击后发现下载没执行或报错，注意检查：</p>

<ol>
  <li>aria2.conf 文件配置是否出错；</li>
  <li>代理工具是否切换到全局穿越模式，如有，则退出全局模式再重试；</li>
</ol>

<p>从后台关闭 Aria2。在终端执行 <code class="highlighter-rouge">kill</code> 命令来关闭 Aria2。</p>

<ul>
  <li>输入 <code class="highlighter-rouge">$ kill aria2c</code> 点 Tab 键，显示 aria2 的进程号，然后 Return。Aria2 的进程将被关闭。</li>
  <li>直接 <code class="highlighter-rouge">$ killalll aria2c</code> 关闭进程。</li>
</ul>

<p>再次使用时需重新运行。</p>

<h2 id="aria2-web-ui">搭配 Aria2 Web UI</h2>

<p>Aria2 不带 GUI 界面。了解下载进度会有不便，日常使用需搭配 Web UI 工具方便查看。</p>

<p>进入网址查看：<a href="http://aria2c.com/">Aria2 Web 控制台</a>（可保存为书签使用。）</p>

<p>界面效果：</p>

<p><img src="http://dreamofbook.qiniudn.com/Aria2ControlUI.png" alt="" /></p>

<hr />

<h2 id="section">优化启动</h2>

<p>利用命令行工具的 alias 进行命令优化，简化 Aria2 命令的输入。</p>

<ol>
  <li>VIM 编辑全局配置文件：
    <ul>
      <li>命令行工具默认：<code class="highlighter-rouge">$ vi ~/.bashrc</code></li>
      <li>配置 zsh 的命令行工具：<code class="highlighter-rouge">$ vi ~/.zshrc</code> </li>
    </ul>
  </li>
  <li>在末尾添加一条新的 alias：
    <ul>
      <li><code class="highlighter-rouge">alias aria="aria2c --conf-path="/Users/YourID/.aria2/aria2.conf" -D"</code> </li>
    </ul>
  </li>
  <li>使之全局生效：
    <ul>
      <li>命令行工具默认：<code class="highlighter-rouge">$ source ~/.bashrc</code></li>
      <li>配置 zsh 的命令行工具：<code class="highlighter-rouge">$ source ~/.zshrc</code> </li>
    </ul>
  </li>
  <li>以后每次开机或重新启用终端后，键入以下命令直接启用 Aria2，使它常驻后台：
    <ul>
      <li><code class="highlighter-rouge">$ aria</code></li>
    </ul>
  </li>
</ol>

<h2 id="section-1">感谢</h2>

<ul>
  <li><a href="https://aria2.github.io/">Aria2</a></li>
  <li><a href="https://blog.icehoney.me/about">雪月秋水</a> 开发的 BaiduExporter</li>
  <li><a href="http://brew.sh/">Homebrew</a></li>
</ul>

<h2 id="section-2">参考资料</h2>

<ul>
  <li><a href="http://azeril.me/blog/Homebrew.html">Homebrew 使用入门 - Microdust</a></li>
  <li><a href="https://blog.icehoney.me/posts/2015-01-31-Aria2-download">使用 Aria2 下载百度网盘和 115 的资源</a></li>
  <li><a href="http://blog.binux.me/2012/12/aria2-examples/">aria2配置示例 - Binuxの杂货铺</a> * <a href="http://blog.csdn.net/myweishanli/article/details/42221481">linux 高速下载工具 aria2 的用法 - myweishanli的专栏 - 博客频道 - CSDN.NET</a></li>
</ul>


                <hr>


                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC A-S 4.0 International License</a>.

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/Reading-Review.html" data-toggle="tooltip" data-placement="top" title="阅读的地图 2015">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/blog/Final-Cut-Pro-X-Shortcuts.html" data-toggle="tooltip" data-placement="top" title="Final Cut Pro X 常用快捷键清单">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Duoshuo Share start -->
                <style>
                    .ds-share{
                        text-align: right;
                    }
                    
                    @media only screen and (max-width: 700px) {
                        .ds-share {

                        }
                    }
                </style>

                <div class="ds-share"
                    data-thread-key="/blog/Aria2" data-title="Aria2——Unix 系统中潜行的下载神器"
                    data-images="http://azeril.me/img/fantasy.jpg"
                    data-content="拥有了 Aria2 的默默扶持，再也不用待见不用忍受 OSX 下国内那些半死不活的下载工具了。

关于 Aria2

Aria2 是一个基于命令行的开源下... | Microdust:Azeril's blog"
                    data-url="http://azeril.me/blog/Aria2.html">
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">

                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">分享到：</a></li>
                        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
                        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-douban" href="javascript:void(0);" data-service="douban">豆瓣</a></li>
                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                <hr>
                </div>
                <!-- Duoshuo Share end-->




                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread" data-thread-key="/blog/Aria2" data-title="Aria2——Unix 系统中潜行的下载神器" data-url="http://azeril.me/blog/Aria2.html"></div>
                </div>
                <!-- 多说评论框 end -->
            </div>
        </div>
    </div>
</article>



<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"azeril"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- 多说公共JS代码 end -->



</script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

  
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <!-- kill the Facebook and Weibo -->
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://twitter.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://github.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <!--
                    
                    <li>
                        <a href="http://www.douban.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-douban fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    <!--
                    
                    <li>
                        <a href="https://www.facebook.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    

                    <!--
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                </ul>
                <p class="copyright text-muted">
                &copy; 2011~2016 Azeril ♪ Powered by Jekyll.
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>




<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js",function(){
        hljs.initHighlightingOnLoad();
    })
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">


</body>

</html>