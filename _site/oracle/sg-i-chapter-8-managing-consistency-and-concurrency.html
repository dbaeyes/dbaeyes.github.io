<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在遙遠的地方 一切虔誠終必相遇">

    <title>SG I: Chapter 8 | Managing Consistency and Concurrency - Microdust</title>

    <link rel="canonical" href="http://dbaeyes.github.io/oracle/sg-i-chapter-8-managing-consistency-and-concurrency.html">

    <!-- Icons -->
  <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Microdust</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/About.html">About</a>
                </li>
                
                <li>
                    <a href="/Lists.html">Reading</a>
                </li>
                
                <li>
                    <a href="/Tools.html">Tools</a>
                </li>
                
                <li>
                    <a href="/tags.html">Tags</a>
                </li>
                
                <li>
                    <a href="/photos/Instagram/">Photos: Instagram</a>
                </li>
                
                <li>
                    <a href="/photos/">Photos</a>
                </li>
                

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/fantasy.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="Tags">
                        
                        <a class="tag" href="/Tags/#oracle" title="oracle">oracle</a>
                        
                        <a class="tag" href="/Tags/#study" title="study">study</a>
                        
                    </div>
                    <h1>SG I: Chapter 8 | Managing Consistency and Concurrency</h1>
                    
                    <span class="meta">Posted by {"login"=>"Toby", "email"=>"renwei.chu@gmail.com", "display_name"=>"David", "first_name"=>"", "last_name"=>""} on February 20, 2008</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container">

                <p><strong><span style="color: #0000ff;">*Undo Management</span></strong></p>
<div>
<p>Monitor and administer undo.<br />
Configure undo retention.<br />
Guarantee undo retention.<br />
Use the Undo Advisor.<br />
Describe the relationship between undo and transactions.<br />
Size the undo tablespace.</p>
<p><span style="color: #0000ff;">*Monitoring and Resolving Lock Conflicts</span><br />
Detect and resolve lock conflicts.<br />
Manage deadlocks.<br />
Describe the relationship between transactions and locks.<br />
Explain lock modes within the Oracle Database 10g.</p>
<p><span style="color: #ff6600; font-size: medium;"><strong>Understanding Undo Segments</strong></span></p>
<p>At the beginning of a transaction—in other words, when the first DML command is issued after a previous COMMIT or a user first connects to the database—the transaction is assigned to an undo segment in the undo tablespace. Any changes to any table in the transaction are recorded in the assigned undo segment.<br />
The names of the current active undo segments can be retrieved from the dynamic performance view <span style="color: #0000ff;">V$ROLLNAME</span>, as you can see in the following query:<br />
The dynamic performance view <span style="color: #0000ff;">V$TRANSACTION</span> shows the relationship between a transaction and the undo segments. In the following query, you begin a transaction and then join <span style="color: #0000ff;">V$TRANSACTION</span> to <span style="color: #0000ff;">V$ROLLNAME</span> to find out the name of the undo segment assigned to the transaction:</p>
<p>SQL&gt; <span style="color: #3366ff;"><em>set transaction name 'Update clerk salaries';</em></span><br />
Transaction set.</p>
<p><em><span style="color: #3366ff;">SQL&gt; update hr.employees set salary = salary * 1.25<br />
2 where job_id like '%CLERK';</span></em><br />
44 rows updated.</p>
<p><span style="color: #3366ff;"><em>SQL&gt; select xid, status, start_time, xidusn seg_num,<br />
2 r.name seg_name<br />
3 from v$transaction t join v$rollname r<br />
4 on t.xidusn = r.usn<br />
5 where t.name = 'Update clerk salaries';</em></span></p>
<p>XID STATUS START_TIME SEG_NUM SEG_NAME<br />
-------- --------- ----------------- ------- -------------<br />
02002F00 ACTIVE 08/01/04 16:20:10 2 _SYSSMU2$<br />
9A140000</p>
<p><span style="color: #ff6600;"><strong>Undo data serves four purposes in an Oracle database:</strong></span><br />
User rollback of a transaction<br />
Read consistency of DML operations and queries<br />
Database recovery operations<br />
Flashback functionality</p>
<p><strong><span style="color: #ff6600;">Guaranteeing Undo Retention</span></strong><br />
If your database requirements are such that you want long-running queries to succeed at the expense of DML in a transaction, such as in a data warehouse environment where a query can run for hours or even days, you can set the RETENTION GUARANTEE parameter for the undo tablespace.<br />
<em><span style="color: #3366ff;">SQL&gt; alter tablespace undotbs1 retention guarantee;<br />
Tablespace altered.</span></em><br />
<strong><span style="color: #ff6600;">Monitoring Locking and Resolving Lock Conflicts</span></strong></p>
<p>&nbsp;</p>
<div><img src="http://hiphotos.baidu.com/dbaeyes/pic/item/b2da82d3ebe724cfa9ec9a84.jpg" alt="" border="0" data-pinit="registered" /></div>
<p>You can explicitly obtain locks on individual rows by using the <span style="color: #0000ff;">SELECT … FOR UPDATE</span> tatement,<br />
as you can see in the following example:<br />
<em><span style="color: #3366ff;">SQL&gt; select * from hr.employees<br />
2 where manager_id = 100<br />
3 for update;</span></em></p>
<p>This query not only shows the rows that satisfy the query conditions, it also locks the selected rows and prevents other transactions from locking or updating these rows until a COMMIT or a ROLLBACK occurs.</p>
<p><strong><span style="color: #ff6600;">NOWAIT Mode<br />
</span></strong>Using NOWAIT in a LOCK TABLE statement returns control to the user immediately if any locks already exist on the requested resource<br />
<strong><span style="color: #ff6600;">Detecting and Resolving Lock Conflicts</span></strong></p>
<p>When database activity is at its peak, the <span style="color: #0000ff;">V$UNDOSTAT</span> view, in conjunction with the value for UNDO_RETENTION and DB_BLOCK_SIZE, can be used to calculate an optimal undo tablespace size.</p>
</div>


                <hr>


                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC A-S 4.0 International License</a>.

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/my%20life/unexpected-flood-of-law-i-now-live-in-the-yellow-river.html" data-toggle="tooltip" data-placement="top" title="法律---意外的水灾--我现在身处黄河中">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/my%20life/climb-the-hill-and-super-lie-in.html" data-toggle="tooltip" data-placement="top" title="爬山and超级懒觉">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Duoshuo Share start -->
                <style>
                    .ds-share{
                        text-align: right;
                    }
                    
                    @media only screen and (max-width: 700px) {
                        .ds-share {

                        }
                    }
                </style>

                <div class="ds-share"
                    data-thread-key="/oracle/sg-i-chapter-8-managing-consistency-and-concurrency" data-title="SG I: Chapter 8 | Managing Consistency and Concurrency"
                    data-images="http://dbaeyes.github.io/img/fantasy.jpg"
                    data-content="*Undo Management

Monitor and administer undo.
Configure undo retention.
Guar... | Microdust:Azeril's blog"
                    data-url="http://dbaeyes.github.io/oracle/sg-i-chapter-8-managing-consistency-and-concurrency.html">
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">

                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">分享到：</a></li>
                        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
                        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-douban" href="javascript:void(0);" data-service="douban">豆瓣</a></li>
                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                <hr>
                </div>
                <!-- Duoshuo Share end-->




                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread" data-thread-key="/oracle/sg-i-chapter-8-managing-consistency-and-concurrency" data-title="SG I: Chapter 8 | Managing Consistency and Concurrency" data-url="http://dbaeyes.github.io/oracle/sg-i-chapter-8-managing-consistency-and-concurrency.html"></div>
                </div>
                <!-- 多说评论框 end -->
            </div>
        </div>
    </div>
</article>



<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"azeril"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- 多说公共JS代码 end -->



</script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

  
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <!-- kill the Facebook and Weibo -->
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://twitter.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://github.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <!--
                    
                    <li>
                        <a href="http://www.douban.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-douban fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    <!--
                    
                    <li>
                        <a href="https://www.facebook.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    

                    <!--
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                </ul>
                <p class="copyright text-muted">
                &copy; 2011~2016 David ♪ Powered by Jekyll.
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>




<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js",function(){
        hljs.initHighlightingOnLoad();
    })
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">


</body>

</html>