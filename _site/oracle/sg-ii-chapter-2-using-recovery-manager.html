<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在遙遠的地方 一切虔誠終必相遇">

    <title>SG II: Chapter 2 | Using Recovery Manager - Microdust</title>

    <link rel="canonical" href="http://dbaeyes.github.io/oracle/sg-ii-chapter-2-using-recovery-manager.html">

    <!-- Icons -->
  <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Microdust</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/About.html">About</a>
                </li>
                
                <li>
                    <a href="/Lists.html">Reading</a>
                </li>
                
                <li>
                    <a href="/Tools.html">Tools</a>
                </li>
                
                <li>
                    <a href="/tags.html">Tags</a>
                </li>
                
                <li>
                    <a href="/photos/Instagram/">Photos: Instagram</a>
                </li>
                
                <li>
                    <a href="/photos/">Photos</a>
                </li>
                

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/fantasy.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="Tags">
                        
                        <a class="tag" href="/Tags/#oracle" title="oracle">oracle</a>
                        
                        <a class="tag" href="/Tags/#sg" title="sg">sg</a>
                        
                        <a class="tag" href="/Tags/#study" title="study">study</a>
                        
                    </div>
                    <h1>SG II: Chapter 2 | Using Recovery Manager</h1>
                    
                    <span class="meta">Posted by {"login"=>"Toby", "email"=>"renwei.chu@gmail.com", "display_name"=>"David", "first_name"=>"", "last_name"=>""} on April 15, 2008</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container">

                <p><strong><span style="color: #ff6600;">Using Recovery Manager</span></strong></p>
<div>
<p>1. Use the RMAN BACKUP command to create backup sets and image copies.<br />
2. Enable block change tracking.<br />
3. Manage the backups and image copies taken with RMAN with the LIST and REPORT commands.</p>
<p>-------------------------------------<br />
<strong><span style="color: #0000ff; font-size: medium;">Creating Backup Sets</span></strong></p>
<p>Last login: Tue Apr 15 21:13:12 2008 from 192.168.18.6<br />
<span>[oracle@localhost ~]$ rman target /</span></p>
<p>Recovery Manager: Release 10.2.0.1.0 - Production on Tue Apr 15 22:00:15 2008</p>
<p>Copyright (c) 1982, 2005, Oracle. All rights reserved.</p>
<p>connected to target database: ORCL (DBID=1179140783)</p>
<p><span>RMAN&gt; show all;</span></p>
<p>using target database control file instead of recovery catalog<br />
RMAN configuration parameters are:<br />
CONFIGURE RETENTION POLICY TO REDUNDANCY 1; # default<br />
CONFIGURE BACKUP OPTIMIZATION OFF; # default<br />
CONFIGURE DEFAULT DEVICE TYPE TO DISK; # default<br />
CONFIGURE CONTROLFILE AUTOBACKUP OFF; # default<br />
CONFIGURE CONTROLFILE AUTOBACKUP FORMAT FOR DEVICE TYPE DISK TO '%F'; # default<br />
CONFIGURE DEVICE TYPE DISK BACKUP TYPE TO COMPRESSED BACKUPSET PARALLELISM 1;<br />
CONFIGURE DATAFILE BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default<br />
CONFIGURE ARCHIVELOG BACKUP COPIES FOR DEVICE TYPE DISK TO 1; # default<br />
CONFIGURE MAXSETSIZE TO UNLIMITED; # default<br />
CONFIGURE ENCRYPTION FOR DATABASE OFF; # default<br />
CONFIGURE ENCRYPTION ALGORITHM 'AES128'; # default<br />
CONFIGURE ARCHIVELOG DELETION POLICY TO NONE; # default<br />
CONFIGURE SNAPSHOT CONTROLFILE NAME TO '/u01/app/oracle/10.2.0/db_1/dbs/snapcf_orcl.f'; # default</p>
<p><span>RMAN&gt; run<br />
2&gt; {<br />
3&gt; allocate channel c1 type disk;<br />
4&gt; backup database format 'db_%u_%d_%s';<br />
5&gt; backup format 'log_t%t_s%s_p%p'<br />
6&gt; (archivelog all);<br />
7&gt; }</span></p>
<p>allocated channel: c1<br />
channel c1: sid=138 devtype=DISK</p>
<p>Starting backup at 15-APR-08<br />
channel c1: starting compressed full datafile backupset<br />
channel c1: specifying datafile(s) in backupset<br />
<span style="color: #3366ff;">input datafile fno=00001 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_system_3zkmhwp7_.dbf<br />
input datafile fno=00003 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_sysaux_3zkmhwpk_.dbf<br />
input datafile fno=00006 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_data_406p21qh_.dbf<br />
input datafile fno=00005 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_db_test_3zpvo97g_.dbf<br />
</span><span style="color: #3366ff;">input datafile fno=00002 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_undotbs1_3zkmhwwq_.dbf<br />
input datafile fno=00004 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_users_3zkmhwy6_.dbf</span><br />
channel c1: starting piece 1 at 15-APR-08<br />
channel c1: finished piece 1 at 15-APR-08<br />
piece handle=/u01/app/oracle/10.2.0/db_1/dbs/db_01jdtp4f_ORCL_1 tag=TAG20080415T222831 comment=NONE<br />
channel c1: backup set complete, elapsed time: 00:00:55<br />
channel c1: starting compressed full datafile backupset<br />
channel c1: specifying datafile(s) in backupset<br />
including current control file in backupset<br />
including current SPFILE in backupset<br />
channel c1: starting piece 1 at 15-APR-08<br />
channel c1: finished piece 1 at 15-APR-08<br />
piece handle=/u01/app/oracle/10.2.0/db_1/dbs/db_02jdtp67_ORCL_2 tag=TAG20080415T222831 comment=NONE<br />
channel c1: backup set complete, elapsed time: 00:00:02<br />
Finished backup at 15-APR-08</p>
<p>Starting backup at 15-APR-08<br />
current log archived<br />
channel c1: starting compressed archive log backupset<br />
channel c1: specifying archive log(s) in backup set<br />
input archive log thread=1 sequence=3 recid=1 stamp=651531129<br />
input archive log thread=1 sequence=4 recid=2 stamp=651960946<br />
input archive log thread=1 sequence=5 recid=3 stamp=652053631<br />
input archive log thread=1 sequence=6 recid=4 stamp=652137344<br />
input archive log thread=1 sequence=7 recid=5 stamp=652141773<br />
channel c1: starting piece 1 at 15-APR-08<br />
channel c1: finished piece 1 at 15-APR-08<br />
piece handle=/u01/app/oracle/10.2.0/db_1/dbs/log_t652141774_s3_p1 tag=TAG20080415T222934 comment=NONE<br />
channel c1: backup set complete, elapsed time: 00:00:26<br />
Finished backup at 15-APR-08<br />
released channel: c1</p>
<p>RMAN&gt;</p>
<p>?? How to change the folder for the backup set? --&gt;</p>
<p>-------------------------------------------</p>
<p>&nbsp;</p>
<p><strong><span style="color: #0000ff;">Creating Image Copies</span></strong></p>
<p>Image copies can be stored only on disk.<br />
The image copy backup cannot be compressed and requires much more space than a backup set.</p>
<p><span>RMAN&gt; run { allocate channel ch1 type disk;<br />
2&gt; copy<br />
3&gt; current controlfile to '/u01/app/oracle/flash_recovery_area/ORCL/bak_test/CONTROL01.ctl';}</span></p>
<p>allocated channel: ch1<br />
channel ch1: sid=138 devtype=DISK</p>
<p>Starting backup at 15-APR-08<br />
channel ch1: starting datafile copy<br />
copying current control file<br />
output filename=/u01/app/oracle/flash_recovery_area/ORCL/bak_test/CONTROL01.ctl tag=TAG20080415T225145 recid=1 stamp=652143106<br />
channel ch1: datafile copy complete, elapsed time: 00:00:01<br />
Finished backup at 15-APR-08<br />
released channel: ch1</p>
<p>RMAN&gt;<br />
----------------------------</p>
<p>In Oracle 10g, there is a new backup command that simplifies image copies: <strong>BACKUP AS COPY</strong>. The benefit of this image copy is that you can perform image copies of an entire database, multiple tablespaces, datafiles, and archive logs without having to specify all of the individual files. In the previous image copy example, the location of the SYSTEM01.DBF file must be known before you do the copy.</p>
<p><span>RMAN&gt; backup as copy tag "080415_backup" database;</span></p>
<p>-----------------------------------------------</p>
<p><strong><span style="color: #0000ff;">Compressed Backups</span></strong></p>
<p>This functions as a normal backup set, but the backup set is compressed.</p>
<p><span>RMAN&gt; backup as compressed backupset database;</span></p>
<p>Starting backup at 15-APR-08<br />
allocated channel: ORA_DISK_1<br />
channel ORA_DISK_1: sid=138 devtype=DISK<br />
channel ORA_DISK_1: starting compressed full datafile backupset<br />
channel ORA_DISK_1: specifying datafile(s) in backupset<br />
<span style="color: #3366ff;">input datafile fno=00001 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_system_3zkmhwp7_.dbf<br />
input datafile fno=00003 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_sysaux_3zkmhwpk_.dbf<br />
input datafile fno=00006 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_data_406p21qh_.dbf<br />
input datafile fno=00005 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_db_test_3zpvo97g_.dbf<br />
input datafile fno=00002 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_undotbs1_3zkmhwwq_.dbf</span><br />
input datafile fno=00004 name=/u01/app/oracle/oradata/ORCL/datafile/o1_mf_users_3zkmhwy6_.dbf<br />
channel ORA_DISK_1: starting piece 1 at 15-APR-08<br />
channel ORA_DISK_1: finished piece 1 at 15-APR-08<br />
piece <span style="color: #3366ff;">handle=/u01/app/oracle/flash_recovery_area/ORCL/backupset/2008_04_15/o1_mf_nnndf_TAG20080415T225737_409jm1s1_.bkp tag=TAG20080415T225737 comment=NONE</span><br />
channel ORA_DISK_1: backup set complete, elapsed time: 00:00:55<br />
channel ORA_DISK_1: starting compressed full datafile backupset<br />
channel ORA_DISK_1: specifying datafile(s) in backupset<br />
including current control file in backupset<br />
including current SPFILE in backupset<br />
channel ORA_DISK_1: starting piece 1 at 15-APR-08<br />
channel ORA_DISK_1: finished piece 1 at 15-APR-08<br />
piece handle=/u01/app/oracle/flash_recovery_area/ORCL/backupset/2008_04_15/o1_mf_ncsnf_TAG20080415T225737_409jntc4_.bkp tag=TAG20080415T225737 comment=NONE<br />
channel ORA_DISK_1: backup set complete, elapsed time: 00:00:03<br />
Finished backup at 15-APR-08<br />
----------------</p>
<p>Configure it as default:</p>
<p><span>RMAN&gt; configure device type disk backup type to compressed backupset;</span></p>
<p>&nbsp;</p>
<p>---------------------------------------------------------------------------</p>
<p><strong><span style="color: #0000ff;">Full and Incremental Backups</span></strong>The <em><strong>differential incremental</strong></em> backup backs up only data blocks modified since the most recent backup at the same level or lower.</p>
<p>The <em><strong>cumulative incremental</strong></em> backup backs up only the data blocks that have changed since the most recent backup of the next lowest level, or n – 1 or lower (with n being the existing level of backup).</p>
<p>the cumulative incremental backup stores more complete information, which takes up more space. However, this negative aspect is compensated by the fact that recovery operations are more efficient.<br />
------------------------------------------------</p>
<p><span style="color: #ff6600;">Performing a Differential Incremental Backup</span></p>
<p>The first incremental backup must be a level 0 backup that contains all used blocks. Next, you can perform a level 1 backup, which will pick up the changed blocks.</p>
<p>RMAN&gt; backup incremental level 0 database;</p>
<p>RMAN&gt; backup incremental level 1 database;</p>
<p><span style="color: #ff6600;">Performing a Cumulative Incremental Backup</span></p>
<p>RMAN&gt; backup incremental level 1 cumulative database;</p>
<p>-------------------------------------------------------</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><span style="color: #ff6600;">Parallelization of Backup Sets</span></strong></p>
<p><span>RMAN&gt;configure device type disk parallelism 3;</span></p>
<p><span>RMAN&gt; backup<br />
2&gt; (datafile 1,2)<br />
3&gt; (datafile 3,4)<br />
4&gt; (archivelog all);</span></p>
<p>------------------</p>
<p><strong><span style="color: #ff6600;">Backup Options</span></strong></p>
<p><span style="color: #0000ff;">FORMAT options</span><br />
%a Specifies the activation ID of the database<br />
%c Specifies the copy number of the backup piece within a set of duplexed backup pieces<br />
%d Specifies the name of the database<br />
%D Specifies the current day of the month from the Gregorian calendar<br />
%e Specifies the archived log sequence number<br />
%f Specifies the absolute file number<br />
%F Combines the database ID (DBID), day, month, year, and sequence into a unique and repeatable generated name<br />
%h Specifies the archived redo log thread number<br />
%I Specifies the DBID<br />
%M Specifies the month in the Gregorian calendar in MM format<br />
%N Specifies the tablespace name<br />
%n Specifies the name of the database, padded on the right with n characters to a total length of eight characters<br />
%p Specifies the piece number within the backup set<br />
%s Specifies the backup set number<br />
%t Specifies the backup set timestamp<br />
%T Specifies the year, month, and day in the Gregorian calendar<br />
%u Specifies an eight-character name constituted by compressed representations of the backup set or image copy number<br />
%U Specifies a system-generated unique filename (this is the default setting)</p>
<p>Exampel：<br />
<span>RMAN&gt; backup tablespace users format='user_bs_%d%p%s';<br />
RMAN&gt; backup as copy tablespace users format= 'C:\oracle\backups\ora101c\users_%d%p%s';</span></p>
<p>The <span style="color: #0000ff;">TAG option</span> is similar to the FORMAT option, but it is a user-specified string value.<br />
<span>RMAN&gt; backup database tag weekly_backup;</span></p>
<p>The <span style="color: #0000ff;">RATE option</span> is designed to limit RMAN from using excessive system resources during backup and restore operations.<br />
set the RATE option to read only 5MB per second:<br />
<span>RMAN&gt; CONFIGURE CHANNEL DEVICE TYPE disk RATE 5M;</span></p>
<p><span><br />
</span></p>
<p><span style="color: #0000ff;">MAXSETSIZE</span> parameter allows you to control the <span style="color: #3366ff;">amount of files per backup set</span> and can make RMAN create additional backup sets. This can have benefits in recovery options because you can recover multiple backup sets in parallel on different channels.<br />
Caution: If the datafile being backed up is larger than the MAXSETSIZE parameter, the backup will fail.</p>
<p><span style="color: #0000ff;">MAXPIECESIZE</span> parameter limits <span style="color: #3366ff;">the size of a backup piece</span>. By default, the RMAN utility will put the entire contents of a backup set into one backup piece, regardless of the size of the backup set. This parameter can be valuable for media managers that have size limitations.</p>
<p><span>RMAN&gt; configure channel device type disk maxsetsize=10G;<br />
RMAN&gt; backup database maxsetsize=10G;<br />
RMAN&gt; configure channel device type disk maxpiecesize = 2G;</span></p>
<p>--------------------------</p>
<p>&nbsp;</p>
<p><strong><span style="color: #ff6600;">Block Change Tracking</span></strong></p>
<p><span>Get status: select * from V$BLOCK_CHANGE_TRACKING</span></p>
<p><span>SQL&gt; alter database enable block change tracking using<br />
2 file 'C:\oracle\block_track\ora101c_block_track.log';</span><br />
or<br />
<span>SQL&gt; alter database disable block change tracking;</span></p>
<p>--------------------------</p>
<p><strong><span style="color: #808000;">Monitoring RMAN Backups</span></strong></p>
<p>Dynamic View Description<br />
V$RMAN_OUTPUT Displays messages reported by an RMAN job in progress.<br />
V$RMAN_STATUS Displays the success or failure of all completed RMAN jobs.<br />
V$PROCESS Shows currently active processes.<br />
V$RECOVER_FILE Shows the datafiles that require recovery.<br />
V$SESSION Shows active sessions.<br />
V$SESSION_LONGOPS Shows progress reports on RMAN backups and restores.<br />
V$SESSION_WAIT Shows the events causing sessions to wait.<br />
V$BACKUP_SYNC_IO Shows the rows when the I/O is synchronous to the backup process.<br />
V$BACKUP_ASYNC_IO Shows the rows when the I/O is asynchronous to the backup process.</p>
<p>---------------------------</p>
<p><strong><span style="color: #ff6600;">Using LIST Commands</span></strong></p>
<p><span style="color: #0000ff;">The LIST commands are used to determine files impacted by the CHANGE, CROSSCHECK, and DELETE commands.</span></p>
<p>&nbsp;</p>
<p><span style="color: #0000ff;">RMAN&gt; list backupset by backup summary;</span></p>
<p><span>using target database control file instead of recovery catalog<br />
List of Backups<br />
===============<br />
Key     TY LV S Device Type Completion Time #Pieces #Copies Compressed Tag<br />
------- -- -- - ----------- --------------- ------- ------- ---------- ---<br />
1       B F A DISK        15-APR-08       1       1       YES        TAG20080415T222831<br />
2       B F A DISK        15-APR-08       1       1       YES        TAG20080415T222831<br />
3       B A A DISK        15-APR-08       1       1       YES        TAG20080415T222934<br />
4       B F A DISK        15-APR-08       1       1       YES        TAG20080415T225737<br />
5       B F A DISK        15-APR-08       1       1       YES        TAG20080415T225737<br />
</span></p>
<p><span><span style="color: #0000ff;">RMAN&gt; list backupset by file; --shows backup sets by file.<br />
</span><br />
List of Datafile Backups<br />
========================<br />
File Key     TY LV S Ckp SCN    Ckp Time #Pieces #Copies Compressed Tag<br />
---- ------- - -- - ---------- --------- ------- ------- ---------- ---<br />
1    4       B F A 602235     15-APR-08 1       1       YES        TAG20080415T225737<br />
1       B F A 601165     15-APR-08 1       1       YES        TAG20080415T222831<br />
2    4       B F A 602235     15-APR-08 1       1       YES        TAG20080415T225737<br />
1       B F A 601165     15-APR-08 1       1       YES        TAG20080415T222831<br />
3    4       B F A 602235     15-APR-08 1       1       YES        TAG20080415T225737<br />
1       B F A 601165     15-APR-08 1       1       YES        TAG20080415T222831<br />
4    4       B F A 602235     15-APR-08 1       1       YES        TAG20080415T225737<br />
1       B F A 601165     15-APR-08 1       1       YES        TAG20080415T222831<br />
5    4       B F A 602235     15-APR-08 1       1       YES        TAG20080415T225737<br />
1       B F A 601165     15-APR-08 1       1       YES        TAG20080415T222831<br />
6    4       B F A 602235     15-APR-08 1       1       YES        TAG20080415T225737<br />
1       B F A 601165     15-APR-08 1       1       YES        TAG20080415T222831</span></p>
<p><span>List of Archived Log Backups<br />
============================</span></p>
<p><span>Thrd Seq     Low SCN    Low Time BS Key S #Pieces #Copies Compressed Tag<br />
---- ------- ---------- --------- ------- - ------- ------- ---------- ---<br />
1    3       488389     07-APR-08 3       A 1       1       YES        TAG20080415T222934<br />
1    4       521469     08-APR-08 3       A 1       1       YES        TAG20080415T222934<br />
1    5       542884     13-APR-08 3       A 1       1       YES        TAG20080415T222934<br />
1    6       567988     14-APR-08 3       A 1       1       YES        TAG20080415T222934<br />
1    7       594527     15-APR-08 3       A 1       1       YES        TAG20080415T222934</span></p>
<p><span>List of Control File Backups<br />
============================</span></p>
<p><span>CF Ckp SCN Ckp Time BS Key S #Pieces #Copies Compressed Tag<br />
---------- --------- ------- - ------- ------- ---------- ---<br />
602258     15-APR-08 5       A 1       1       YES        TAG20080415T225737<br />
601183     15-APR-08 2       A 1       1       YES        TAG20080415T222831<br />
List of SPFILE Backups<br />
======================</span></p>
<p><span>Modification Time BS Key S #Pieces #Copies Compressed Tag<br />
----------------- ------- - ------- ------- ---------- ---<br />
15-APR-08         5       A 1       1       YES        TAG20080415T225737<br />
15-APR-08         2       A 1       1       YES        TAG20080415T222831</span></p>
<p>Also can querying V$BACKUP_FILES and RC_BACKUP_FILES.</p>
<p>----------------------------</p>
<p><strong><span style="color: #ff6600;">Using REPORT Commands</span></strong></p>
<p>The REPORT command is best used to identify which files need a backup, unneeded backups, database physical schema, and if unrecoverable operations were performed on files.</p>
<p>The REPORT command options include REPORT NEED BACKUP, REPORT OBSOLETE, and REPORT SCHEMA.</p>
<p><span style="color: #0000ff;">RMAN&gt; REPORT OBSOLETE; --no longer needed based on the existing retention policy</span></p>
<p><span>RMAN retention policy will be applied to the command<br />
RMAN retention policy is set to recovery window of 30 days<br />
no obsolete backups found</span></p>
<p><span style="color: #0000ff;">MAN&gt; REPORT SCHEMA; --display the physical structure of the database</span></p>
<p><span>Report of database schema</span></p>
<p><span>List of Permanent Datafiles<br />
===========================<br />
File Size(MB) Tablespace           RB segs Datafile Name<br />
---- -------- -------------------- ------- ------------------------<br />
1    480      SYSTEM               ***     /u01/app/oracle/oradata/ORCL/datafile/o1_mf_system_3zkmhwp7_.dbf<br />
2    25       UNDOTBS1             ***     /u01/app/oracle/oradata/ORCL/datafile/o1_mf_undotbs1_3zkmhwwq_.dbf</span></p>
<p>------------------------------------</p>
<p><strong><span style="color: #ff6600; font-size: medium;">Examples Using RMAN</span></strong></p>
<p><span style="color: #0000ff;">Enabling ARCHIVELOG Mode for 9i</span></p>
<p>1. SQL&gt; alter system set log_archive_start=true scope=spfile;</p>
<p>2. LOG_ARCHIVE_DEST=/d01/arch/ora101c<br />
LOG_ARCHIVE_FORMAT= arch%s.arc</p>
<p>3. SQL&gt; connect / as sysdba<br />
SQL&gt; startup nomount<br />
SQL&gt; alter database archivelog;<br />
SQL&gt; alter database open;</p>
<p><span style="color: #0000ff;">Using RMAN to Back Up Archived Redo Logs</span></p>
<p>run {<br />
allocate channel c1 type disk;<br />
allocate channel c2 type disk;<br />
backup database;<br />
backup (archivelog all);<br />
}</p>
<p><span style="color: #0000ff;">Scheduling a Backup Job</span></p>
<p>rman target <a href="mailto:sys/sys_password@target_db">sys/sys_password@target_db</a> catalog <a href="mailto:.rman_user/rman_password@rman_catalog_db@daily_backup.rcv">.rman_user/rman_password@rman_catalog_db@daily_backup.rcv</a></p>
<p>--------------------------------------</p>
<p><span style="color: #0000ff;"><em><strong>case:</strong></em></span></p>
<p>Some guys delete some archive log because there is no enough space on the disk and the system will be halt.<br />
Then the DBA need backup the archive log will met a problem because not all the archive logs are available. he RMAN repository or the RMAN catalog knows the required archive logs that are needed since the last backup. RMAN will not allow you to back up the database without the complete set of archive logs. How can solve it?</p>
<p>This can be performed with RMAN command CHANGE ARCHIVELOG ALL CROSSCHECK. This command tells RMAN to use the available archive logs only and disregard the deleted ones. This information becomes the new baseline for this database.</p>
<p>-- EOF --</p>
</div>


                <hr>


                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC A-S 4.0 International License</a>.

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/my%20life/game-time.html" data-toggle="tooltip" data-placement="top" title="Game Time">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/os/unix-quick-charging.html" data-toggle="tooltip" data-placement="top" title="UNIX 快速充电">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Duoshuo Share start -->
                <style>
                    .ds-share{
                        text-align: right;
                    }
                    
                    @media only screen and (max-width: 700px) {
                        .ds-share {

                        }
                    }
                </style>

                <div class="ds-share"
                    data-thread-key="/oracle/sg-ii-chapter-2-using-recovery-manager" data-title="SG II: Chapter 2 | Using Recovery Manager"
                    data-images="http://dbaeyes.github.io/img/fantasy.jpg"
                    data-content="Using Recovery Manager

1. Use the RMAN BACKUP command to create backup sets ... | Microdust:Azeril's blog"
                    data-url="http://dbaeyes.github.io/oracle/sg-ii-chapter-2-using-recovery-manager.html">
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">

                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">分享到：</a></li>
                        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
                        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-douban" href="javascript:void(0);" data-service="douban">豆瓣</a></li>
                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                <hr>
                </div>
                <!-- Duoshuo Share end-->




                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread" data-thread-key="/oracle/sg-ii-chapter-2-using-recovery-manager" data-title="SG II: Chapter 2 | Using Recovery Manager" data-url="http://dbaeyes.github.io/oracle/sg-ii-chapter-2-using-recovery-manager.html"></div>
                </div>
                <!-- 多说评论框 end -->
            </div>
        </div>
    </div>
</article>



<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"azeril"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- 多说公共JS代码 end -->



</script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

  
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <!-- kill the Facebook and Weibo -->
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://twitter.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://github.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <!--
                    
                    <li>
                        <a href="http://www.douban.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-douban fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    <!--
                    
                    <li>
                        <a href="https://www.facebook.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    

                    <!--
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                </ul>
                <p class="copyright text-muted">
                &copy; 2011~2016 David ♪ Powered by Jekyll.
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>




<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js",function(){
        hljs.initHighlightingOnLoad();
    })
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">


</body>

</html>