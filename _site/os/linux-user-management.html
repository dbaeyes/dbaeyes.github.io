<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="在遙遠的地方 一切虔誠終必相遇">

    <title>Linux用户管理 - Microdust</title>

    <link rel="canonical" href="http://dbaeyes.github.io/os/linux-user-management.html">

    <!-- Icons -->
  <link rel="shortcut icon" href="img/favicon.ico">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Microdust</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                <li>
                    <a href="/About.html">About</a>
                </li>
                
                <li>
                    <a href="/Lists.html">Reading</a>
                </li>
                
                <li>
                    <a href="/Tools.html">Tools</a>
                </li>
                
                <li>
                    <a href="/tags.html">Tags</a>
                </li>
                
                <li>
                    <a href="/photos/Instagram/">Photos: Instagram</a>
                </li>
                
                <li>
                    <a href="/photos/">Photos</a>
                </li>
                

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/fantasy.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="Tags">
                        
                        <a class="tag" href="/Tags/#linux" title="linux">linux</a>
                        
                        <a class="tag" href="/Tags/#user" title="user">user</a>
                        
                    </div>
                    <h1>Linux用户管理</h1>
                    
                    <span class="meta">Posted by {"login"=>"Toby", "email"=>"renwei.chu@gmail.com", "display_name"=>"David", "first_name"=>"", "last_name"=>""} on April 20, 2008</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 post-container">

                <p><span style="font-family: 宋体;">本文主要介绍</span>Linux<span style="font-family: 宋体;">系统的用户和用户组的查询、添加、修改及删除等管理工具；</span></p>
<div>
<p>Linux<span style="font-family: 宋体;">是一个多用户的操作系统，她有完美的用户管理工具，这些工具包括用户的查询、添加、修改，以及用户之间相互切换的工具等；通过这些工具，我们能安全、轻松的完成用户管理；</span></p>
<p><strong><span style="font-family: 宋体;">一、与用户管理相关的配置文件</span></strong><strong><br />
</strong><span style="font-size: medium;"><strong>1</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>/etc/passwd?</strong><strong><span style="font-family: 宋体;">和</span></strong><strong>/etc/groups</strong></span></p>
<p><span style="font-family: 宋体;">在</span>linux<span style="font-family: 宋体;">系统下，对用户和用户组进行添加、修改、删除等操作的最终目的都是通过修改用户和组的配置文件来实现的，这些主要配置文件主要有：</span>/etc/passwd<span style="font-family: 宋体;">、</span>/etc/shadows<span style="font-family: 宋体;">、</span>/etc/groups<span style="font-family: 宋体;">、</span>/etc/gshadow<span style="font-family: 宋体;">、</span>/etc/skel?<span style="font-family: 宋体;">目录等；</span></p>
<p><span style="font-family: 宋体;">用户和用户组的配置文件，是系统管理员最应该了解和掌握的系统基础之一，从另一方面来说，了解这些文件也是系统安全管理的重要组成部分；</span></p>
<p>1<span style="font-family: 宋体;">、</span>/etc/passwd?<span style="font-family: 宋体;">用户帐号密码文件</span></p>
<p><span style="font-family: 宋体;">[root@jekay /]# cat /etc/passwd</span></p>
<p><span style="font-family: 宋体;">登陆名???口令?UID???GID?用户全称和描述???用户主目录???用户登陆的shell环境</span></p>
<p><span style="font-family: 宋体;">root:x:0:0:root:/root:/bin/bash</span></p>
<p><span style="font-family: 宋体;">bin:x:1:1:bin:/bin:/sbin/nologin</span></p>
<p><span style="font-family: 宋体;">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></p>
<p><span style="font-family: 宋体;">adm:x:3:4:adm:/var/adm:/sbin/nologin</span></p>
<p><span style="font-family: 宋体;">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></p>
<p><span style="font-family: 宋体;">sync:x:5:0:sync:/sbin:/bin/sync</span></p>
<p><span style="font-family: 宋体;">……</span></p>
<p align="left">在/etc/passwd?中，每一行都表示的是一个用户的信息；一行有7个段位；每个段位用：号分割，如上：</p>
<p><span style="font-family: 宋体;"><strong>说明：</strong></span></p>
<p align="left"><strong>UID</strong>是用户的ID值，<strong>是确认用户权限的标识，</strong>在系统中每个用户的UID的值是唯一的，更确切的说每个用户都要对应一个<strong>唯一</strong>的UID?，系统管理员应该确保这一规则。系统用户的UID的值从0开始，是一个正整数，至于最大值可以在/etc/login.defs?可以查到，一般Linux发行版约定为60000；?在Linux?中，root的UID是0，拥有系统最高权限；把几个用户设置为同样的UID会造成系统安全的隐患，尤其是设置成root的?UID号0；</p>
<p align="left">Linux系统中的用户角色：</p>
<p><span style="font-family: 宋体;">用户在系统中是分角色的，在Linux?系统中，由于角色不同，权限和所完成的任务也不同；值得注意的是用户的角色是通过UID和识别的，特别是UID；在系统管理中，系统管理员一定要坚守UID?唯一的特性；</span></p>
<p><span style="font-family: NSimsun;">root?用户：系统唯一，是真实的，可以登录系统，可以操作系统任何文件和命令，拥有最高权限；</span></p>
<p><span style="font-family: NSimsun;">虚拟用户：这类用户也被称之为伪用户或假用户，与真实用户区分开来，这类用户不具有登录系统的能力，但却是系统运行不可缺少的用户，比如bin、daemon、adm、ftp、mail等；这类用户都系统自身拥有的，而非后来添加的，当然我们也可以添加虚拟用户；</span></p>
<p><span style="font-family: NSimsun;">普通用户：这类用户能登录系统，但只能操作自己家目录的内容；权限有限；这类用户都是系统管理员自行添加的；</span></p>
<p align="left">/etc/login.defs是设置用户帐号限制的文件,在这里我们可配置密码的最大过期天数,密码的最大长度约束等内容；</p>
<p>???<span style="font-family: 宋体;">多数发行版本，添加新用户时的</span>UID<span style="font-family: 宋体;">从</span>500<span style="font-family: 宋体;">开始的，</span>GID<span style="font-family: 宋体;">也是从</span>500<span style="font-family: 宋体;">开始；</span>500<span style="font-family: 宋体;">内的为系统预留；</span></p>
<p>&nbsp;</p>
<p>2<span style="font-family: 宋体;">、</span>/etc/shadows?<span style="font-family: 宋体;">用户帐号的加密文件</span></p>
<p><span style="font-family: 宋体;">[root@jekay /]# cat /etc/shadow</span></p>
<p><span style="font-family: 宋体;">root:$1$MebjzxXM$0hVmQ6MMDB5ZVVAGuUG7G1:13599:0:99999:7:::</span></p>
<p><span style="font-family: 宋体;">bin:*:13599:0:99999:7:::</span></p>
<p><span style="font-family: 宋体;">daemon:*:13599:0:99999:7:::</span></p>
<p><span style="font-family: 宋体;">adm:*:13599:0:99999:7:::</span></p>
<p><span style="font-family: 宋体;">lp:*:13599:0:99999:7:::</span></p>
<p><span style="font-family: 宋体;">sync:*:13599:0:99999:7:::</span></p>
<p><span style="font-family: 宋体;">……</span></p>
<p>/etc/shadow?文件的内容包括9个段位，每个段位之间用：号分割；</p>
<p><span style="font-family: 宋体;">第一字段： 用户名（也被称为登录名）</span><span style="font-family: 宋体;">，在/etc/shadow中，用户名和/etc/passwd?是相同的，这样就把passwd?和shadow中用的用户记录联系在一起；这个字段是非空的；</span><br />
<span style="font-family: 宋体;">第二字段：密码（已被加密），如果是有些用户在这段是x，表示这个用户不能登录到系统；这个字段是非空的；</span><br />
<span style="font-family: 宋体;">第三字段：上次修改口令的时间；这个时间是从1970年01月01日算起到最近一次修改口令的时间间隔（天数），您可以通过passwd?来修改用户的密码，然后查看/etc/shadow中此字段的变化；</span><br />
<span style="font-family: 宋体;">第四字段：两次修改口令间隔最少的天数；如果设置为0,则禁用此功能；也就是说用户必须经过多少天才能修改其口令；此项功能用处不是太大；默认值是通过/etc/login.defs文件定义中获取，PASS_MIN_DAYS?中有定义；</span><br />
<span style="font-family: 宋体;">第五字段：两次修改口令间隔最多的天数；这个能增强管理员管理用户口令的时效性，应该说在增强了系统的安全性；如果是系统默认值，是在添加用户时由/etc/login.defs文件定义中获取，在PASS_MAX_DAYS?中定义；</span><br />
<span style="font-family: 宋体;">第六字段：提前多少天警告用户口令将过期；当用户登录系统后，系统登录程序提醒用户口令将要作废；如果是系统默认值，是在添加用户时由/etc/login.defs文件定义中获取，在PASS_WARN_AGE?中定义；</span><br />
<span style="font-family: 宋体;">第七字段：在口令过期之后多少天禁用此用户；此字段表示用户口令作废多少天后，系统会禁用此用户，也就是说系统会不能再让此用户登录，也不会提示用户过期，是完全禁用；</span><br />
<span style="font-family: 宋体;">第八字段：用户过期日期；此字段指定了用户作废的天数（从1970年的1月1日开始的天数），如果这个字段的值为空，帐号永久可用；</span><br />
<span style="font-family: 宋体;">第九字段：保留字段；</span></p>
<p>/etc/shadow<span style="font-family: 宋体;">文件是</span>/etc/passwd?<span style="font-family: 宋体;">的投影文件，这个文件并不由</span>/etc/passwd?<span style="font-family: 宋体;">而产生的，这两个文件是应该是对应互补的；</span>shadow<span style="font-family: 宋体;">内容包括用户及被加密的密码以及其它</span>/etc/passwd?<span style="font-family: 宋体;">不能包括的信息，比如用户的有效期限等；这个文件只有</span>root<span style="font-family: 宋体;">权限可以读取和操作，权限如下：</span></p>
<p><span style="font-family: 宋体;">-r--------????1 root?????root??????????740 Mar 27 17:03 /etc/shadow</span></p>
<p>&nbsp;</p>
<p>3<span style="font-family: 宋体;">、</span>/etc/groups?<span style="font-family: 宋体;">用户组帐号文件</span></p>
<p><span style="font-family: 宋体;">具有某种共同特征的用户集合起来就是用户组（</span>Group<span style="font-family: 宋体;">）。用户组（</span>Group<span style="font-family: 宋体;">）配置文件主要有</span>?/etc/group<span style="font-family: 宋体;">和</span>/etc/gshadow<span style="font-family: 宋体;">，其中</span>/etc/gshadow<span style="font-family: 宋体;">是</span>/etc/group<span style="font-family: 宋体;">的加密信息文件；</span></p>
<p>/etc/group<span style="font-family: 宋体;">文件相对来说比较简单，通过这个配置文件，我们可以清楚地看到系统中用户组，以及用户属于哪个组，某个组中的用户成员有谁等；</span></p>
<p align="left">Linux系统下用户组分为2种，用户私有组和公有组；</p>
<p align="left">私用组:只包含一个用户,创建用户时自动创建一个和用户同名的组</p>
<p align="left">公有组:可以包含多个用户</p>
<p><span style="font-family: 宋体;">当一个用户属于多个用户组时，某个用户的权限只能是当前所属组的权限，而不能是多个组权限的累加，这与</span>windows<span style="font-family: 宋体;">是不一样的；</span></p>
<p><span style="font-family: 宋体;">不要随便把普通用户加入到</span>root<span style="font-family: 宋体;">组；</span></p>
<p><span style="font-family: 宋体;">[root@jekay /]# cat /etc/group</span></p>
<p><span style="font-family: 宋体;">组名???群组密码???GID???组中用户列表</span></p>
<p><span style="font-family: 宋体;">root:x:0:root</span></p>
<p><span style="font-family: 宋体;">bin:x:1:root,bin,daemon</span></p>
<p><span style="font-family: 宋体;">daemon:x:2:root,bin,daemon</span></p>
<p><span style="font-family: 宋体;">sys:x:3:root,bin,adm</span></p>
<p><span style="font-family: 宋体;">adm:x:4:root,adm,daemon</span></p>
<p><span style="font-family: 宋体;">tty:x:5:</span></p>
<p><span style="font-family: 宋体;">……</span></p>
<p>在/etc/group?中的每条记录分四个字段，中间使用：隔开</p>
<p align="left"><strong>GID</strong>和UID类似，是一个正整数或0，是用户组的ID值，GID从0开始，?0被系统赋予root用户组；系统会预留一些较靠前的GID给系统虚拟用户组之用；多数linux发行版本预留了500，也就是说新用户组的GID从500开始；查看/etc/login.defs?中的?GID_MIN?和GID_MAX?值，可以知道GID的最大设置值；</p>
<p>4<span style="font-family: 宋体;">、</span>/etc/gshadow?<span style="font-family: 宋体;">用户组帐号的加密文件</span></p>
<p><span style="font-family: 宋体;">[root@jekay /]# cat /etc/gshadow</span></p>
<p><span style="font-family: 宋体;">用户组名????用户组密码???用户组的管理者???组成员列表</span></p>
<p><span style="font-family: 宋体;">root:::root</span></p>
<p><span style="font-family: 宋体;">bin:::root,bin,daemon</span></p>
<p><span style="font-family: 宋体;">daemon:::root,bin,daemon</span></p>
<p><span style="font-family: 宋体;">sys:::root,bin,adm</span></p>
<p><span style="font-family: 宋体;">adm:::root,adm,daemon</span></p>
<p><span style="font-family: 宋体;">tty:::</span></p>
<p><span style="font-family: 宋体;">……</span></p>
<p>/etc/gshadow<span style="font-family: 宋体;">是</span>/etc/group<span style="font-family: 宋体;">的加密文件；</span></p>
<p><span style="font-family: 宋体;">用户组密码，用于结构比较复杂的权限模型；</span></p>
<p>5<span style="font-family: 宋体;">、</span>/etc/skel?<span style="font-family: 宋体;">目录</span>?<span style="font-family: 宋体;">用来初始化用户的主目录</span></p>
<p><span style="font-family: 宋体;">[root@jekay /]# ls -al /etc/skel</span></p>
<p><span style="font-family: 宋体;">total 20</span></p>
<p><span style="font-family: 宋体;">drwxr-xr-x????2 root?????root?????????4096 Mar 27 16:59 .</span></p>
<p><span style="font-family: 宋体;">drwxr-xr-x???32 root?????root?????????4096 Mar 27 17:04 ..</span></p>
<p><span style="font-family: 宋体;">-rw-r--r--????1 root?????root???????????24 Feb 11?2003 .bash_logout</span></p>
<p><span style="font-family: 宋体;">-rw-r--r--????1 root?????root??????????191 Feb 11?2003 .bash_profile</span></p>
<p><span style="font-family: 宋体;">-rw-r--r--????1 root?????root??????????124 Feb 11?2003 .bashrc</span></p>
<p><span style="font-family: 宋体;">目录中存放有与用户相关的配置文件。一般来说，每个用户都有自己的主目录，用户</span></p>
<p><span style="font-family: 宋体;">成功登录后就处于自己的主目录下。</span></p>
<p><span style="font-family: 宋体;">当为新用户创建主目录时，系统会在新用户的主目录下建立一份</span>/etc/skel<span style="font-family: 宋体;">目录下所有文件的拷贝，用来初始化用户的主目录。</span></p>
<p><span style="font-size: medium;"><strong>2</strong><strong><span style="font-family: 宋体;">、超级权限控制</span></strong><strong>sudo?</strong><strong><span style="font-family: 宋体;">的配置文件</span></strong><strong>?/etc/sudoers</strong></span></p>
<p align="left">root超级用户是系统最高权限的拥有者；几乎无所不能，多数的系统设置和权限设置对root帐号来说是无用的；所以root帐号权限管理不善就会造成系统安全的隐患；</p>
<p align="left">在对系统操作时尽量避免使用root登陆，也应该尽量避免直接使用root帐号对系统进行配置和操作；但有时普通用户可能需要root权限来完成必要的系统管理工作，我们可以使用su和sudo来实现；</p>
<p align="left"><span style="font-size: medium;"><strong>用户帐号类型：</strong></span></p>
<p align="left">超级用户：在Linux操作系统中，root的权限是最高的，也被称为超级权限的拥有者。普通用户无法执行的操作，root用户都能完成，所以也被称之为超级管理用户。在系统中，每个文件、目录和进程，都归属于某一个用户，没有用户许可其它普通用户是无法操作的，但对root除外。root用户的特权性还表现在root可以超越任何用户和用户组来对文件或目录进行读取、修改或删除（在系统正常的许可范围内）；对可执行程序的执行、终止；对硬件设备的添加、创建和移除等；也可以对文件和目录进行属主和权限进行修改，以适合系统管理的需要（因为root是系统中权限最高的特权用户）；UID为0；</p>
<p align="left">普通用户和伪装用户：与超级用户相对的就是普通用户和虚拟（也被称为伪装用户），普通和伪装用户都是受限用户；但为了完成特定的任务，普通用户和伪装用户也是必须的；Linux是一个多用户、多任务的操作系统，多用户主要体现在用户的角色的多样性，不同的用户所分配的权限也不同；这也是Linux系统比Windows系统更为安全的本质所在；</p>
<p align="left">但值得注意的是超级用户的操作是在系统最高许可范围内的操作；有些操作就是具有超级权限的root也无法完成；如：/proc目录、加了写保护的文件等；</p>
<p><span style="font-family: 宋体;">[root@jekay /]# ls -ld /proc</span></p>
<p><span style="font-family: NSimsun;">dr-xr-xr-x???47 root?????root????????????0 Mar 27 12:03 /proc</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">[root@jekay tmp]# chattr +i file</span></p>
<p><span style="font-family: 宋体;">[root@jekay tmp]# rm -f file</span></p>
<p><span style="font-family: 宋体;">rm: cannot remove `file': Operation not permitted</span></p>
<p>&nbsp;</p>
<p align="left">获取超级权限的过程，就是切换普通用户身份到超级用户身份的过程；这个过程主要是通过su和sudo?来解决；</p>
<p align="left"><span style="font-size: medium;"><strong>使用</strong><strong>?su?</strong><strong>命令临时切换用户身份</strong></span></p>
<p align="left">su命令就是切换用户的工具；</p>
<p align="left">su [OPTION选项参数] [用户]<br />
-, -l, --login?登录并改变到所切换的用户环境；<br />
-c, --commmand=COMMAND?执行一个命令，然后退出所切换到的用户环境；</p>
<p>&nbsp;</p>
<p align="left">su?在不加任何参数，默认为切换到root用户，不改变shell环境；</p>
<p align="left">su?加参数?-?，表示默认切换到root用户，并且改变到root用户的环境；</p>
<p align="left">su?的确为管理带来方便，通过切换到root下，能完成所有系统管理工具，只要把root的密码交给任何一个普通用户，他都能切换到root来完成所有的系统管理工作；但如果登陆的用户比较多，而多个用户都需要使用root权限，这时就可能会造成安全隐患，而且由于切换的过程是打开root的shell环境，很多情况下也会造成root权限外泻；</p>
<p align="left"><span style="font-size: medium;"><strong>sudo</strong><strong>工具</strong></span></p>
<p><span style="font-family: 宋体;">由于</span>su?<span style="font-family: 宋体;">对切换到超级权限用户</span>root<span style="font-family: 宋体;">后，权限的无限制性，所以</span>su<span style="font-family: 宋体;">并不能担任多个管理员所管理的系统。通过</span>sudo<span style="font-family: 宋体;">，我们能把某些超级权限有针对性的下放，并且不需要普通用户知道</span>root<span style="font-family: 宋体;">密码，所以</span>sudo?<span style="font-family: 宋体;">相对于权限无限制性的</span>su<span style="font-family: 宋体;">来说，还是比较安全的，所以</span>sudo?<span style="font-family: 宋体;">也能被称为受限制的</span>su?<span style="font-family: 宋体;">；另外</span>sudo?<span style="font-family: 宋体;">是需要授权许可的，所以也被称为授权许可的</span>su<span style="font-family: 宋体;">；</span></p>
<p align="left"><strong>????</strong>sudo?执行命令的流程是当前用户切换到root（或其它指定切换到的用户），然后以root（或其它指定的切换到的用户）身份执行命令，执行完成后，直接退回到当前用户；而这些的前提是要通过sudo的配置文件/etc/sudoers来进行授权；</p>
<p align="left">sudo的配置文件是/etc/sudoers?；可通过命令visudo直接进行编辑；</p>
<p align="left">通过sudo -l?来查看哪些命令是可以执行或禁止的；</p>
<p align="left">/etc/sudoers?文件中每行算一个规则，前面带有#号可以当作是说明的内容，并不执行；如果规则很长，一行列不下时，可以用\号来续行，这样看来一个规则也可以拥有多个行；</p>
<p align="left">/etc/sudoers?的规则可分为两类；一类是别名定义，另一类是授权规则；别名定义并不是必须的，但授权规则是必须的；</p>
<p><strong><span style="font-family: 宋体;">默认</span></strong><strong>/etc/sudoers</strong><span style="font-family: 宋体;"><strong>配置文件</strong></span></p>
<p><strong>[root@jekay]# cat /etc/sudoers</strong></p>
<p><span style="font-family: 宋体;"># sudoers file.</span></p>
<p><span style="font-family: 宋体;"># This file MUST be edited with the 'visudo' command as root.</span></p>
<p><span style="font-family: 宋体;"># See the sudoers man page for the details on how to write a sudoers file.</span></p>
<p><span style="font-family: 宋体;"># Host alias specification</span></p>
<p><span style="font-family: 宋体;"># User alias specification</span></p>
<p><span style="font-family: 宋体;"># Cmnd alias specification</span></p>
<p><span style="font-family: 宋体;"># Defaults specification</span></p>
<p><span style="font-family: 宋体;"># User privilege specification</span></p>
<p><span style="font-family: 宋体;">root????ALL=(ALL) ALL</span></p>
<p><span style="font-family: 宋体;"># Uncomment to allow people in group wheel to run all commands</span></p>
<p><span style="font-family: 宋体;"># %wheel????????ALL=(ALL)???????ALL</span></p>
<p><span style="font-family: 宋体;"># Same thing without a password</span></p>
<p><span style="font-family: 宋体;"># %wheel????????ALL=(ALL)???????NOPASSWD: ALL</span></p>
<p><span style="font-family: 宋体;"># Samples</span></p>
<p><span style="font-family: 宋体;"># %users?ALL=/sbin/mount /cdrom,/sbin/umount /cdrom</span></p>
<p><span style="font-family: 宋体;"># %users?localhost=/sbin/shutdown -h now</span></p>
<p align="left">别名规则定义格式如下：</p>
<p align="left">Alias_Type NAME = item1, item2, ...</p>
<p align="left">或Alias_Type NAME = item1, item2, item3 : NAME = item4, item5</p>
<p align="left">别名类型（Alias_Type）：别名类型包括如下四种</p>
<p align="left">Host_Alias 定义主机别名；项目可以是主机名、可以是单个ip（整段ip地址也可以），也可以是网络掩码；</p>
<p align="left">Host_Alias BE01=localhost,bt05,tt04,10.0.0.4,255.255.255.0,192.168.1.0/24 注：定义主机别名HT01，通过=号列出成员</p>
<p align="left">User_Alias 用户别名，别名成员可以是用户，用户组（前面要加%号）</p>
<p align="left">User_Alias SYSAD=jekay,linux,lt,benet:NETAD=jekay:WEBMASTER=admin</p>
<p align="left">Runas_Alias 用来定义runas别名，这个别名指定的是“目的用户”，即sudo 允许切换至的用户；</p>
<p align="left">Runas_Alias OP = root, operator</p>
<p align="left">Cmnd_Alias 定义命令别名；</p>
<p align="left">Cmnd_Alias DISKMAG=/sbin/fdisk,/sbin/parted<br />
Cmnd_Alias NETMAG=/sbin/ifconfig,/etc/init.d/network<br />
Cmnd_Alias KILL = /usr/bin/kill</p>
<p align="left">NAME 就是别名了，NMAE的命名是包含大写字母、下划线以及数字，但必须以一个大写字母开头；</p>
<p align="left">item 按中文翻译是项目，在这里我们可以译成成员，如果一个别名下有多个成员，成员与成员之间，通过半角,号分隔；成员在必须是有效并事实存在的。</p>
<p align="left">item成员受别名类型 Host_Alias、User_Alias、Runas_Alias、Cmnd_Alias 制约，定义什么类型的别名，就要有什么类型的成员相配。我们用Host_Alias定义主机别名时，成员必须是与主机相关相关联，比如是主机名（包括远程登录的主机名）、ip地址（单个或整段）、掩码等；当用户登录时，可以通过w命令来查看登录用户主机信息；用User_Alias和Runas_Alias定义时，必须要用系统用户做为成员；用Cmnd_Alias 定义执行命令的别名时，必须是系统存在的文件，文件名可以用通配符表示，配置Cmnd_Alias时命令需要绝对路径；其中 Runas_Alias 和User_Alias 有点相似，但与User_Alias 绝对不是同一个概念，Runas_Alias 定义的是某个系统用户可以sudo 切换身份到Runas_Alias 下的成员；我们在授权规则中以实例进行解说；</p>
<p align="left">别名规则是每行算一个规则，如果一个别名规则一行容不下时，可以通过\来续行；同一类型别名的定义，一次也可以定义几个别名，他们中间用:号分隔，</p>
<p><strong>/etc/sudoers</strong><span style="font-family: 宋体;"><strong>中的授权规则</strong></span></p>
<p align="left">授权规则是分配权限的执行规则，我们前面所讲到的定义别名主要是为了更方便的授权引用别名；如果系统中只有几个用户，其实下放权限比较有限的话，可以不用定义别名，而是针对系统用户直接直接授权，所以在授权规则中别名并不是必须的；</p>
<p align="left">授权用户 主机=命令动作</p>
<p align="left">这三个要素缺一不可，但在动作之前也可以指定切换到特定用户下，在这里指定切换的用户要用( )号括起来，如果不需要密码直接运行命令的，应该加NOPASSWD:参数，但这些可以省略；</p>
<p><strong><span style="font-family: 宋体;">授权用户</span></strong><strong>?</strong><strong><span style="font-family: 宋体;">主机</span></strong><strong>=[(</strong><strong><span style="font-family: 宋体;">切换到哪些用户或用户组</span></strong><strong>)] [</strong><strong><span style="font-family: 宋体;">是否需要密码验证</span></strong><strong>]?</strong><strong><span style="font-family: 宋体;">命令</span></strong><strong>1,[(</strong><strong><span style="font-family: 宋体;">切换到哪些用户或用户组</span></strong><strong>)] [</strong><strong><span style="font-family: 宋体;">是否需要密码验证</span></strong><strong>] [</strong><strong><span style="font-family: 宋体;">命令</span></strong><strong>2],[(</strong><strong><span style="font-family: 宋体;">切换到哪些用户或用户组</span></strong><strong>)] [</strong><strong><span style="font-family: 宋体;">是否需要密码验证</span></strong><strong>] [</strong><strong><span style="font-family: 宋体;">命令</span></strong><strong>3]......</strong></p>
<p align="left"><strong>注解：</strong></p>
<p><span style="font-family: 宋体;">凡是</span>[ ]<span style="font-family: 宋体;">中的内容，是可以省略；命令与命令之间用</span>,<span style="font-family: 宋体;">号分隔；可以使用NOPASSWD参数，就不要在运行命令时提示密码输入；</span></p>
<p><span style="font-family: 宋体;">举例：</span></p>
<p align="left">jekay?ALL=(root) /bin/chown,/bin/chmod?????????????????执行时会提示输入jekay的密码</p>
<p align="left">jekay?ALL=(root)?NOPASSWD：?/bin/chown,/bin/chmod??????就不需要密码</p>
<p align="left">jekay?ALL=(root) NOPASSWD:?/bin/more</p>
<p align="left">????????????????????????切换到jekay用户下使用more /etc/shadow就可以了，不会提示输入密码</p>
<p align="left">User_Alias SYSUSER=jekay</p>
<p align="left">SYSUSER???ALL=(root) /sbin/fdisk</p>
<p align="left">?????????????????????????使用用户别名来完成；</p>
<p>&nbsp;</p>
<p align="left"><span style="font-size: medium;"><strong>sudo [</strong><strong>参数选项</strong><strong>]?</strong><strong>命令</strong></span><br />
-l?列出用户在主机上可用的和被禁止的命令；一般配置好/etc/sudoers后，要用这个命令来查看和测试是不是配置正确的；<br />
-v?验证用户的时间戳；如果用户运行sudo?后，输入用户的密码后，在短时间内可以不用输入口令来直接进行sudo?操作；用-v?可以跟踪最新的时间戳；<br />
-u?指定以以某个用户执行特定操作；<br />
-k?删除时间戳，下一个sudo?命令要求用求提供密码；</p>
<p>&nbsp;</p>
<p><span style="font-size: medium;"><strong>3</strong><strong><span style="font-family: 宋体;">、添加用户规则文件</span></strong><strong>?/etc/login.defs?</strong><strong><span style="font-family: 宋体;">和</span></strong><strong>?/etc/default/useradd</strong></span></p>
<p align="left"><strong>/etc/login.defs?</strong><strong>配置文件</strong></p>
<p align="left">/etc/login.defs?文件是当创建用户时的一些规划，比如创建用户时，是否需要家目录，UID和GID的范围；用户的期限等等，这个文件是可以通过root来定义的；</p>
<p align="left">/etc/logins.defs?文件内容；</p>
<p align="left"># *REQUIRED*<br />
# Directory where mailboxes reside, _or_ name of file, relative to the<br />
# home directory. If you _do_ define both, MAIL_DIR takes precedence.<br />
# QMAIL_DIR is for Qmail<br />
#<br />
#QMAIL_DIR Maildir<br />
MAIL_DIR /var/spool/mail?注：创建用户时，要在目录/var/spool/mail中创建一个用户mail文件；<br />
#MAIL_FILE .mail<br />
# Password aging controls:<br />
#<br />
# PASS_MAX_DAYS Maximum number of days a password may be used.<br />
# PASS_MIN_DAYS Minimum number of days allowed between password changes.<br />
# PASS_MIN_LEN Minimum acceptable password length.<br />
# PASS_WARN_AGE Number of days warning given before a password expires.<br />
#<br />
PASS_MAX_DAYS 99999?注：用户的密码不过期最多的天数；<br />
PASS_MIN_DAYS 0?注：密码修改之间最小的天数；<br />
PASS_MIN_LEN 5?注：密码最小长度；<br />
PASS_WARN_AGE 7?注：<br />
#<br />
# Min/max values for automatic uid selection in useradd<br />
#<br />
UID_MIN 500?注：最小UID为500?，也就是说添加用户时，UID?是从500开始的；<br />
UID_MAX 60000?注：最大UID为60000；<br />
#<br />
# Min/max values for automatic gid selection in groupadd<br />
#<br />
GID_MIN 500?注：GID?是从500开始；<br />
GID_MAX 60000<br />
#<br />
# If defined, this command is run when removing a user.<br />
# It should remove any at/cron/print jobs etc. owned by<br />
# the user to be removed (passed as the first argument).<br />
#<br />
#USERDEL_CMD /usr/sbin/userdel_local<br />
## If useradd should create home directories for users by default<br />
# On RH systems, we do. This option is ORed with the -m flag on<br />
# useradd command line.<br />
#<br />
CREATE_HOME yes?注：是否创用户家目录，要求创建；</p>
<p align="left"><strong>/etc/default/useradd?</strong><strong>文件</strong></p>
<p align="left">通过useradd?添加用户时的规则文件；</p>
<p align="left"># useradd defaults file<br />
GROUP=100<br />
HOME=/home?注：把用户的家目录建在/home中；<br />
INACTIVE=-1?注：是否启用帐号过期停权，-1表示不启用；<br />
EXPIRE=?注：帐号终止日期，不设置表示不启用；<br />
SHELL=/bin/bash?注：所用SHELL的类型；<br />
SKEL=/etc/skel?注： 默认添加用户的目录默认文件存放位置；也就是说，当我们用adduser添加用户时，用户家目录下的文件，都是从这个目录中复制过去的；</p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;"><strong>二、用户相关工具命令；</strong></span></p>
<p>1<span style="font-family: 宋体;">、添加用户工具有</span>useradd<span style="font-family: 宋体;">和</span>adduser?<span style="font-family: 宋体;">，这两个工具所达到的目的都是一样的；</span></p>
<p>2<span style="font-family: 宋体;">、通过修改用户配置文件</span>/etc/passwd<span style="font-family: 宋体;">和</span>/etc/groups<span style="font-family: 宋体;">的办法来实现；</span></p>
<p>3<span style="font-family: 宋体;">、还有图形下的工具；</span></p>
<p><span style="font-size: medium;"><strong>1</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>useradd?</strong><span style="font-family: 宋体;"><strong>工具</strong></span></span></p>
<p>Useradd<span style="font-family: 宋体;">添加用户时，先读取</span>/etc/login.defs<span style="font-family: 宋体;">和</span>/etc/default/useradd<span style="font-family: 宋体;">中所定义的规则添加用户；并向</span>/etc/passwd<span style="font-family: 宋体;">和</span>/etc/groups<span style="font-family: 宋体;">文件添加用户和用户组记录；当然</span>/etc/passwd<span style="font-family: 宋体;">和</span>/etc/groups<span style="font-family: 宋体;">的加密文件也同步生成记录；同时发生的还有系统会自动在</span>/etc/add/default<span style="font-family: 宋体;">中所约定的目录中建用户的主目录，并复制</span>/etc/skel<span style="font-family: 宋体;">中的文件（包括隐藏文件）到新用户的主目录中；</span></p>
<p>useradd?<span style="font-family: 宋体;">的语法：</span></p>
<p><strong><span style="font-size: medium;">(1)</span>????????????</strong><span style="font-size: medium;"><strong><span style="font-family: 宋体;">对</span></strong><strong>/etc/default/useradd</strong><span style="font-family: 宋体;"><strong>进行修改，设置添加的新用户的默认设置；</strong></span></span></p>
<p><span style="font-family: 宋体;">useradd -D [-g group] [-b base] [-s shell]</span><br />
<span style="font-family: NSimsun;">???????????????? [-f inactive] [-e expire ]</span></p>
<p>&nbsp;</p>
<p><span style="font-family: NSimsun;">???????-D选项出现时，显示/etc/default/useradd配置文件中设置的useradd的设置；</span></p>
<p><span style="font-family: NSimsun;">???????-b?default_home?注：定义用户所属目录的前一个目录。用户名称会附加在default_home后面用来建立新用户的目录。当然使用-d后则此选项无效。</span><br />
<span style="font-family: NSimsun;">???????-e?default_expire_date?注：用户帐号停止日期。</span><br />
<span style="font-family: NSimsun;">???????-f?default_inactive?注：帐号过期几日后停权。</span><br />
<span style="font-family: NSimsun;">???????-g?default_group?注：新帐号起始用户组名或ID。用户组名须为现有存在的名称。用户组ID也须为现有存在的用户组。</span><br />
<span style="font-family: NSimsun;">??????? -s?default_shell?注：用户登入后使用的shell名称。往后新加入的帐号都将使用此shell.</span><br />
<span style="font-family: NSimsun;">???????如不指定任何参数，useradd显示目前预设的值</span></p>
<p><span style="font-size: medium;"><strong>(2)useradd?</strong><span style="font-family: 宋体;"><strong>添加用户；</strong></span></span></p>
<p><span style="font-family: 宋体;">useradd [-u uid [-o]] [-g group] [-G group,...]</span><br />
<span style="font-family: 宋体;">???????????????? [-d home] [-s shell] [-c comment] [-m [-k template]]</span><br />
<span style="font-family: NSimsun;">???????????????? [-f inactive] [-e expire ] [-p passwd] name</span></p>
<p><span style="font-family: NSimsun;">useradd?可使用的选项为</span><br />
<span style="font-family: NSimsun;">???????-c?comment?注：新帐号?password?档的说明栏 。</span><br />
<span style="font-family: NSimsun;">???????-d?home_dir?注：新帐号每次登入时所使用的home_dir。预设值为default_home内login名称，并当成登入时目录名称。</span><br />
<span style="font-family: NSimsun;">??????? -e?expire_date?注：帐号终止日期。日期的指定格式为MM/DD/YY。</span><br />
<span style="font-family: NSimsun;">???????-f?inactive_days?注：帐号过期几日后永久停权。当值为0时帐号则立刻被停权。而当值为-1时则关闭此功能，预设值为-1</span><br />
<span style="font-family: NSimsun;">???????-g?initial_group?注：group名称或以数字来做为用户登入起始用户组(group)。用户组名须为现有存在的名称。用户组数字也须为现有存在的用户组。预设的用户组数字为1。</span><br />
<span style="font-family: 宋体;">???????-G?group,[...]</span><br />
<span style="font-family: NSimsun;">??????????????注：定义此用户为此一堆groups的成员。每个用户组使用","区格开来，不可以夹杂空白字元。用户组名同-g选项的限制。定义值为用户的起始用户组。。</span><br />
<span style="font-family: NSimsun;">???????-m?注：用户目录如不存在则自动建立。如使用-k选项skeleton_dir内的档案将复制至用户目录下。然而在/etc/skel目录下的档案也会复制过去取代。任何在skeleton_dir or /etc/skel的目录也相同会在用户目录下一一建立。The-k同-m不建立目录以及不复制任何档案为预设值。</span><br />
<span style="font-family: NSimsun;">???????-M?不建立用户目录，即使/etc/login.defs系统档设定要建立用户目录。</span><br />
<span style="font-family: NSimsun;">???????-n?预设值用户用户组与用户名称会相同。此选项将取消此预设值。</span><br />
<span style="font-family: NSimsun;">???????-r?此参数是用来建立系统帐号。系统帐号的UID会比定义在系统档上/etc/login.defs.的UID_MIN来的小。注意useradd此用法所建立的帐号不会建立用户目录，也不会在乎纪录在/etc/login.defs.的定义值。如果你想要有用户目录须额外指定-m参数来建立系统帐号。</span><br />
<span style="font-family: NSimsun;">???????-s?shell?注：用户登入后使用的shell名称。预设为不填写，这样系统会帮你指定预设的登入shell。</span><br />
<span style="font-family: NSimsun;">???????-u?uid uid用户的ID值。必须为唯一的ID值，除非用-o选项。数字不可为负值。预设为以/etc/login.defs中的UID_MIN的值为准，0到UID_MIN的值之间，为系统保留的UID?；</span></p>
<p><span style="font-size: medium;"><strong>2</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>userdel?</strong><span style="font-family: 宋体;"><strong>用法；</strong></span></span></p>
<p>userdel?<span style="font-family: 宋体;">的语法格式：</span></p>
<p><strong>userdel [-r]?</strong><span style="font-family: 宋体;"><strong>名称</strong></span></p>
<p>userdel<span style="font-family: 宋体;">很简单，只有一个参数可选</span>?-r?<span style="font-family: 宋体;">；如果加参数</span>-r?<span style="font-family: 宋体;">，表示在删除用户的同时，一并把用户的家目录及本地邮件存储的目录或文件也一同删除；</span></p>
<p>userdel?<span style="font-family: 宋体;">参数</span>?<span style="font-family: 宋体;">用户名</span></p>
<p><strong><span style="font-family: 宋体;">警告：</span></strong>?<span style="font-family: 宋体;">请不要轻易用</span>-r<span style="font-family: 宋体;">参数；他会删除用户的同时删除用户所有的文件和目录；如果用户目录下有重要的文件，在删除前请备份；</span></p>
<p><span style="font-size: medium;"><strong>3</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>usermod?</strong><span style="font-family: 宋体;"><strong>用户修改工具（极其强大）</strong></span></span></p>
<p>usermod?<span style="font-family: 宋体;">不仅能改用户的</span>SHELL<span style="font-family: 宋体;">类型，所归属的用户组，也能改用户密码的有效期，还能改登录名。</span></p>
<p><span style="font-family: 宋体;">usermod [-u uid [-o]] [-g group] [-G group,...]</span><br />
<span style="font-family: NSimsun;">???????????????? [-d?主目录?[-m]] [-s shell] [-c?注释] [-l?新名称]</span><br />
<span style="font-family: NSimsun;">???????????????? [-f?失效日] [-e?过期日] [-p?密码] [-L|-U]?用户名</span><br />
<span style="font-family: NSimsun;">-c?comment</span><br />
<span style="font-family: NSimsun;">???????更新用户帐号password档中的注解栏，一般是使用chfn(1)来修改。</span><br />
<span style="font-family: NSimsun;">-d?home_dir</span><br />
<span style="font-family: NSimsun;">???更新用户新的登入目录。如果给定-m选项，用户旧目录会搬到新的目录去，如旧目录不存在则建个新的。</span><br />
<span style="font-family: NSimsun;">-e?expire_date?加上用户帐号停止日期。日期格式为MM/DD/YY.</span><br />
<span style="font-family: NSimsun;">-f?inactive_days?帐号过期几日后永久停权。当值为0时帐号则立刻被停权。而当值为-1时则关闭此功能。预设值为-1。</span><br />
<span style="font-family: NSimsun;">-g?initial_group?更新用户新的起始登入用户组。用户组名须已存在。用户组ID必须参照既有的的用户组。用户组ID预设值为1。</span><br />
<span style="font-family: NSimsun;">-G?group,[...]?定义用户为一堆groups的成员。每个用户组使用","区格开来，不可以夹杂空白字元。用户组名同-g选项的限制。如果用户现在的用户组不再此列，则将用户由该用户组中移除。</span><br />
<span style="font-family: NSimsun;">-l?login_name?变更用户login时的名称为login_name。其它不变。特别是，用户目录名应该也会跟着更动成新的登入名。</span><br />
<span style="font-family: NSimsun;">-s?shell?指定新登入shell。如此栏留白，系统将选用系统预设shell。</span><br />
<span style="font-family: NSimsun;">-u?uid用户ID值。必须为唯一的ID值，除非用-o选项。数字不可为负值。预设为最小不得小于/etc/login.defs中定义的UID_MIN值。0到UID_MIN值之间是传统上保留给系统帐号使用。用户目录树下所有的档案目录其userID会自动改变。放在用户目录外的档案则要自行手动更动。</span><br />
<span style="font-family: NSimsun;">警告:usermod不允许你改变正在线上的用户帐号名称。当usermod用来改变userID,必须确认这名user没在电脑上执行任何程序。你需手动更改用户的crontab档。也需手动更改用户的at工作档。采用NISserver须在server上更动相关的NIS设定。</span></p>
<p>&nbsp;</p>
<p><strong><span style="font-family: 宋体;">警告：</span></strong>?usermod?<span style="font-family: 宋体;">最好不要用它来改用户的密码，因为他在</span>/etc/shadow<span style="font-family: 宋体;">中显示的是明口令；修改用户的口令最好用</span>passwd?<span style="font-family: 宋体;">；</span></p>
<p><span style="font-size: medium;"><strong>4</strong><strong><span style="font-family: 宋体;">、添加用户组命令</span></strong><strong>groupadd?</strong><span style="font-family: 宋体;"><strong>；</strong></span></span></p>
<p><span style="font-family: 宋体;">语法格式：</span></p>
<p><strong>groupadd [-g gid [-o]] [-r] [-f]?</strong><span style="font-family: 宋体;"><strong>组名</strong></span></p>
<p><span style="font-family: NSimsun;">-g?后接GID值，除非使用-o参数不然该值必须是唯一，不可相同，数值不可为负，预设值以/etc/login.defs为准；</span><br />
<span style="font-family: 宋体;">-r</span><span style="font-family: 'Times New Roman';">?</span><span style="font-family: 宋体;">此参数是用来建立系统帐号的GID会比定义在系统档文件上/etc/login.defs?的GID_MIN来的小。注意useradd此用法所建立的帐号不会建立使用者目录，也不会纪录在/etc/login.defs.的定义值。如果你想要有使用者目录须额外指定-m参数来建立系统帐号，它会自动帮你选定一个小于的GID_MIN的值，不需要再加上-g参数。</span><br />
<span style="font-family: NSimsun;">-f?This is force flag.新增一个已经存在的用户组帐号，系统会出现错误讯息然后结束groupadd。</span></p>
<p>&nbsp;</p>
<p><span style="font-size: medium;"><strong>5</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>groupdel</strong><span style="font-family: 宋体;"><strong>的用法；</strong></span></span></p>
<p>groupdel?<span style="font-family: 宋体;">是用来删除用户组的；</span></p>
<p><strong><span style="font-family: 宋体;">语法格式：</span></strong>groupdel?<span style="font-family: 宋体;">用户组</span></p>
<p>&nbsp;</p>
<p><span style="font-size: medium;"><strong>6</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>passwd</strong><span style="font-family: 宋体;"><strong>命令；</strong></span></span></p>
<p><span style="font-family: 宋体;">我们已经学会如何添加用户了，所以我们还要学习设置或修改用户的密码；</span>passwd<span style="font-family: 宋体;">命令的用法也很多，我们只选如下的几个参数加以说明；想了解更多，请参考</span>man passwd<span style="font-family: 宋体;">或</span>passwd --help?<span style="font-family: 宋体;">；</span></p>
<p><strong><br />
passwd [OPTION...]</strong></p>
<p>passwd?<span style="font-family: 宋体;">作为普通用户和超级权限用户都可以运行，但作为普通用户只能更改自己的用户密码，但前提是没有被</span>root<span style="font-family: 宋体;">用户锁定；如果</span>root<span style="font-family: 宋体;">用户运行</span>passwd?<span style="font-family: 宋体;">，可以设置或修改任何用户的密码；</span></p>
<p>passwd?<span style="font-family: 宋体;">命令后面不接任何参数或用户名，则表示修改当前用户的密码；</span></p>
<p><span style="font-family: NSimsun;">[root@localhost]# passwd?注：没有加任何用户，我是用root用户来执行的passwd?表示修改root用户的密码；下面也有提示；</span><br />
<span style="font-family: 宋体;">Changing password for user root.</span><br />
<span style="font-family: NSimsun;">New UNIX password:?注：请输入新密码；</span><br />
<span style="font-family: NSimsun;">Retype new UNIX password:?注：验证新密码；</span><br />
<span style="font-family: NSimsun;">passwd: all authentication tokens updated successfully.?注：修改root密码成功；</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">如果新建用户后，要为新用户创建密码，则用</span>?<strong>passwd?</strong><strong><span style="font-family: 宋体;">用户名</span></strong>?<span style="font-family: 宋体;">，注意要以</span>root<span style="font-family: 宋体;">用户的权限来创建；</span></p>
<p>passwd?<span style="font-family: 宋体;">几个比较重要的参数<strong>；</strong></span></p>
<p><span style="font-family: 宋体;">[root@localhost]# passwd --help</span><br />
<span style="font-family: 宋体;">Usage: passwd [OPTION...] &lt;accountName&gt;</span><br />
<span style="font-family: NSimsun;">?? -k,?--keep-tokens keep non-expired authentication tokens</span><br />
<span style="font-family: NSimsun;">??????????????????????????注：保留即将过期的用户在期满后能仍能使用；</span><br />
<span style="font-family: NSimsun;">?? -d,?--delete delete the password for the named account (root only)</span><br />
<span style="font-family: NSimsun;">??????????????????????????注：删除用户密码，仅能以root权限操作；</span><br />
<span style="font-family: NSimsun;">?? -l,?--lock lock the named account (root only)</span><br />
<span style="font-family: NSimsun;">??????????????????????????注：锁住用户无权更改其密码，仅能通过root权限操作；</span><br />
<span style="font-family: NSimsun;">?? -u,?--unlock unlock the named account (root only)</span><br />
<span style="font-family: NSimsun;">??????????????????????????注：解除锁定；</span><br />
<span style="font-family: NSimsun;">?? -f,?--force force operation</span><br />
<span style="font-family: NSimsun;">??????????????????????????注：强制操作；仅root权限才能操作；</span><br />
<span style="font-family: NSimsun;">?? -x,?--maximum=DAYS maximum password lifetime (root only)</span></p>
<p><span style="font-family: 宋体;">注：两次密码修正的最大天数，后面接数字；仅能root权限操作；</span><br />
<span style="font-family: NSimsun;">?? -n,?--minimum=DAYS minimum password lifetime (root only)</span></p>
<p><span style="font-family: 宋体;">注：两次密码修改的最小天数，后面接数字，仅能root权限操作；</span><br />
<span style="font-family: NSimsun;">?? -w,?--warning=DAYS number of days warning users receives before</span></p>
<p><span style="font-family: 宋体;">注：在距多少天提醒用户修改密码；仅能root权限操作；</span><br />
<span style="font-family: 宋体;">?????????????????????????? password expiration (root only)</span><br />
<span style="font-family: NSimsun;">?? -i,?--inactive=DAYS number of days after password expiration when an</span></p>
<p><span style="font-family: 宋体;">注：在密码过期后多少天，用户被禁掉，仅能以root操作；</span><br />
<span style="font-family: 宋体;">?????????????????????????? account becomes disabled (root only)</span><br />
<span style="font-family: NSimsun;">?? -S,?--status report password status on the named account (root only)</span></p>
<p><span style="font-family: 宋体;">注：查询用户的密码状态，仅能root用户操作；</span><br />
<span style="font-family: NSimsun;">??????????????????????????? --stdin read new tokens from stdin (root only)</span></p>
<p><strong><span style="font-family: 宋体;">注意：</span></strong>?<span style="font-family: 宋体;">当我们清除一个用户的密码时，登录时就无需密码；这一点要加以注意；</span></p>
<p><span style="font-size: medium;"><strong>7</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>chage?</strong><span style="font-family: 宋体;"><strong>修改用户密码有效期限的命令；</strong></span></span></p>
<p>chage?<span style="font-family: 宋体;">用语法格式：</span></p>
<p><span style="font-family: NSimsun;">chage [-l] [-m?最小天数] [-M?最大天数] [-W?警告] [-I?失效日] [-E?过期日] [-d?最后日]?用户</span></p>
<p>&nbsp;</p>
<p><span style="font-size: medium;"><strong>8</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>chfn?</strong><span style="font-family: 宋体;"><strong>修改用户信息工具；</strong><strong></strong></span></span></p>
<p>chfn?<span style="font-family: 宋体;">这个工具主要是用来改用户的全名，办公室地址，电话之类的；用法如下：</span></p>
<p><span style="font-family: NSimsun;">chfn [ -f full-name ] [ -o office ] [ -p office-phone ] [ -h home-phone ] [ -u ] [ -v ] [ username ]</span></p>
<p>&nbsp;</p>
<p><span style="font-family: NSimsun;">[root@localhost]# chfn linux?注：更改用户linux的信息；</span><br />
<span style="font-family: 宋体;">Changing finger information for linux.</span><br />
<span style="font-family: NSimsun;">Name []: jekay Linux?注：用户全名jekay Linux?，随便写一个就行；</span><br />
<span style="font-family: 宋体;">Office []: benet</span><br />
<span style="font-family: 宋体;">Office Phone []: 44444444</span><br />
<span style="font-family: 宋体;">Home Phone []: 88888888</span><br />
<span style="font-family: NSimsun;">Finger information changed.?注：更改完成；</span></p>
<p>&nbsp;</p>
<p><span style="font-size: medium;"><strong>9</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>chsh?</strong><strong><span style="font-family: 宋体;">改变用户的</span></strong><strong>SHELL</strong><span style="font-family: 宋体;"><strong>类型；</strong><strong></strong></span></span></p>
<p><span style="font-family: 宋体;">[root@localhost]# chsh --help</span><br />
<span style="font-family: NSimsun;">Usage: chsh [ -s shell ] [ --list-shells ] [ --help ] [ --version ] [ username ]</span></p>
<p><span style="font-family: 宋体;">如果</span>chsh?<span style="font-family: 宋体;">不加任何参数及用户名的情况下，默认为更改当前操作用户的</span>SHELL<span style="font-family: 宋体;">类型；</span></p>
<p><span style="font-family: 宋体;">举例说明：</span></p>
<p><span style="font-family: NSimsun;">[root@localhost]# chsh --list-shells?注：列出当前系统中所有的SHELL；</span><br />
<span style="font-family: 宋体;">/bin/sh</span><br />
<span style="font-family: 宋体;">/bin/bash</span><br />
<span style="font-family: NSimsun;">/sbin/nologin?注：这个是不允许用户登录系统所用，是极为有用的；您可以通过查看/etc/passwd?中看哪些用户是nologin；</span><br />
<span style="font-family: 宋体;">/bin/ksh</span><br />
<span style="font-family: 宋体;">/bin/tcsh</span><br />
<span style="font-family: 宋体;">/bin/csh</span><br />
<span style="font-family: 宋体;">/bin/zsh</span><br />
<span style="font-family: NSimsun;">[root@localhost]# chsh -s /bin/ksh linux?注：更改linux所用的shell为ksh?；</span><br />
<span style="font-family: 宋体;">Changing shell for linux.</span><br />
<span style="font-family: NSimsun;">Shell changed.?注：更改完成；</span></p>
<p><span style="font-size: medium;"><strong>10</strong><strong><span style="font-family: 宋体;">、</span></strong><strong>gpasswd???</strong><span style="font-family: 宋体;"><strong>设置一个组的群组密码</strong></span></span></p>
<p><span style="font-family: 宋体;">格式：</span>gpasswd?<span style="font-family: 宋体;">参数</span>?<span style="font-family: 宋体;">用户名</span>?<span style="font-family: 宋体;">组名</span></p>
<p><span style="font-family: NSimsun;">???????-a----将一个用户加入到一个组中</span></p>
<p><span style="font-family: NSimsun;">???????-d----将一个用户从一个组中删除掉</span></p>
<p><span style="font-family: NSimsun;">???????-r----取消一个用户组的群组密码</span></p>
<p><span style="font-family: NSimsun;">-g----修改一个用户组的gid号</span></p>
<p><span style="font-family: NSimsun;">-n----修改一个用户组的组名???groupmod -n?新组名 老组名</span></p>
<p align="center">finger?参数 用户名</p>
<p align="center">id?选项 用户名</p>
<p>&nbsp;</p>
<p align="left">除了直接查看用户（User）和用户组（Group）配置文件的办法除外，我们还有id和finger工具可用，我们一样通过命令行的操作，来完成对用户的查询；id和finger，是两个各有测重的工具，</p>
<p align="left">id工具更测重用户、用户所归属的用户组、UID?和GID?的查看；</p>
<p align="left">finger侧重用户资讯的查询，比如用户名（登录名）、电话、家目录、登录SHELL类型、真实姓名、空闲时间等等；</p>
<p align="left"><strong>id?</strong><strong>命令用法：</strong></p>
<p><span style="font-family: 宋体;">[root@localhost /]# id jekay</span></p>
<p><span style="font-family: 宋体;">uid=500(jekay) gid=500(jekay) groups=500(jekay)</span></p>
<p align="left"><strong>finger?</strong><strong>的用法：</strong></p>
<p><span style="font-family: 宋体;">finger [</span><span style="font-family: 宋体;">参数选项] [用户名］</span><br />
<span style="font-family: 宋体;">-l?</span><span style="font-family: 宋体;">采用长格式（默认），显示由-s选项所包含的所有信息，以及主目录、办公地址、办公电话、登录SHELL、邮件状态、.plan、.project和.forward；</span><br />
<span style="font-family: 宋体;">-m?</span><span style="font-family: 宋体;">禁止对用户真实名字进行匹配；</span><br />
<span style="font-family: 宋体;">-p?</span><span style="font-family: 宋体;">把.plan和.project文件中的内容省略；</span><br />
<span style="font-family: 宋体;">-s?</span><span style="font-family: 宋体;">显示短格式，用户名（也被称为登录名Login）、真实名字（NAME）、在哪个终端登录（Tty）、写状态、空闲时间（Idle）、登录时间（Login Time）、办公地点、办公电话等；</span></p>
<p>&nbsp;</p>
<p><span style="font-family: 宋体;">[root@localhost /]# finger jekay</span></p>
<p><span style="font-family: 宋体;">Login: jekay????????????????????????????Name: (null)</span></p>
<p><span style="font-family: 宋体;">Directory: /home/jekay??????????????????Shell: /bin/bash</span></p>
<p><span style="font-family: 宋体;">Never logged in.</span></p>
<p><span style="font-family: 宋体;">No mail.</span></p>
<p><span style="font-family: 宋体;">No Plan.</span></p>
<p align="left">查看用户信息还可以通过配置文件去查询用户和组的信息；</p>
<p align="left">w、who和users工具，是查询已登录当前主机的用户；另外finger -s?也同样能查询；侧重点不一样；</p>
<p align="left">[root@localhost /]# w</p>
<p align="left">22:43:44?up?3:03,?1 user,?load average: 0.00, 0.00, 0.00</p>
<p align="left">USER?????TTY??????FROM??????????????LOGIN@???IDLE???JCPU???PCPU?WHAT</p>
<p align="left">root?????pts/0????192.168.1.104?????7:41pm?0.00s?1.93s?0.35s?w</p>
<p align="left">[root@localhost /]# who</p>
<p align="left">root?????pts/0????????Mar 27 19:41 (192.168.1.104)</p>
<p align="left">[root@localhost /]# users</p>
<p align="left">rootbeinan pts/4 :0.0 12:06 0.00s 0.21s 0.00s w</p>
<p align="left">????w命令功能更加强大，它不但可以显示有谁登录到系统，还可以显示出这些用户当前正在进行的工作，并且统计数据相对who命令来说更加详细和科学，可以认为w命令就是who命令的一个增强版。</p>
<p align="left">????w命令的显示项目按以下顺序排列：</p>
<p align="left">????-----当前时间，系统启动到现在的时间，登录用户的数目，系统在最近1秒、5秒和15秒的平均负载。</p>
<p align="left">???然后是每个用户的各项数据，项目显示顺序如下：</p>
<p align="left"><span style="font-family: Tahoma;">?? -----</span>登录帐号、终端名称、远程主机名、登录时间、空闲时间、JCPU、PCPU、当前正在运行进程的命令行。</p>
<p>&nbsp;</p>
<p align="left"><strong>16</strong><strong>、</strong><strong>pwcov?</strong>注：同步用户从/etc/passwd?到/etc/shadow</p>
<p align="left"><strong>pwck</strong>?注：pwck是校验用户配置文件/etc/passwd?和/etc/shadow?文件内容是否合法或完整；</p>
<p align="left"><strong>pwunconv?</strong>注：是pwcov?的立逆向操作，是从/etc/shadow和?/etc/passwd?创建/etc/passwd?，然后会删除?/etc/shadow?文件；</p>
<p align="left"><strong>visudo?</strong>来编辑/etc/sudoers来实现；visodo?是编辑?/etc/sudoers?的命令；也可以不用这个命令，直接用vi?来编辑?/etc/sudoers?的效果是一样的；</p>
<p align="left"><strong>通过修改用户和用户组配置文件的办法来添加用户和组</strong></p>
<p align="left"><strong>流程：</strong></p>
<p align="left"><strong>1</strong><strong>）修改</strong><strong>?/etc/passwd?</strong><strong>，添加用户记录；</strong></p>
<p align="left">jekay:x:508:508::/home/jekay:/bin/bash</p>
<p align="left">然后执行pwconv?，让/etc/passwd?和/etc/shadow同步，您可以查看?/etc/shadow的内容是否同步；</p>
<p align="left">[root@localhost]# pwconv</p>
<p align="left"><strong>2</strong><strong>）修改</strong><strong>/etc/group</strong><strong>，添加私有用户组</strong></p>
<p align="left">jekay:x:508:</p>
<p align="left">其次，是运行?grpconv?来同步/etc/group?和/etc/gshadow内容，您可以通过查看/etc/gshadow的内容变化确认是不是添加组成功了；</p>
<p align="left">[root@localhost]# grpconv</p>
<p align="left"><strong>3</strong><strong>）创建用户的主目录，并把用户启动文件也复制过去；</strong></p>
<p align="left">在/home下创建jekay用户的主目录，名称与用户名相同，另外我们还需要把/etc/skel?目录下的.*隐藏文件复制过去；</p>
<p align="left">[root@localhost]# cp -R /etc/skel/ /home/jekay<br />
[root@localhost]# ls -la /home/jekay</p>
<p align="left"><strong>4</strong><strong>）改变新增用户家目录的属主和权限；</strong></p>
<p align="left">我们发现新增用户的主目录的属主目前是root?，并且主目录下的隐藏文件也是root权限；</p>
<p align="left">[root@localhost]# chown -R jekay.jekay /home/jekay</p>
<p align="left">[root@localhost]# chmod 700 /home/jekay/</p>
<p align="left"><strong>5</strong><strong>）设置新增用户的密码；</strong></p>
<p align="left"><strong>passwd?</strong><strong>的用法：</strong></p>
<p align="left">passwd?用户名</p>
<p align="left"><strong>6</strong><strong>）测试添增用户是否成功；</strong></p>
<p align="left"><a href="http://unix-cd.com/unixcd12/article_6561.html">http://unix-cd.com/unixcd12/article_6561.html</a></p>
</div>


                <hr>


                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC A-S 4.0 International License</a>.

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/os/unix-quick-charging.html" data-toggle="tooltip" data-placement="top" title="UNIX 快速充电">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/oracle/sg-ii-chapter-3-recovering-from-non-critical-losses.html" data-toggle="tooltip" data-placement="top" title="SG II: Chapter 3 | Recovering From Non-Critical Losses">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Duoshuo Share start -->
                <style>
                    .ds-share{
                        text-align: right;
                    }
                    
                    @media only screen and (max-width: 700px) {
                        .ds-share {

                        }
                    }
                </style>

                <div class="ds-share"
                    data-thread-key="/os/linux-user-management" data-title="Linux用户管理"
                    data-images="http://dbaeyes.github.io/img/fantasy.jpg"
                    data-content="本文主要介绍Linux系统的用户和用户组的查询、添加、修改及删除等管理工具；

Linux是一个多用户的操作系统，她有完美的用户管理工具，这些工具包括用户... | Microdust:Azeril's blog"
                    data-url="http://dbaeyes.github.io/os/linux-user-management.html">
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">

                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">分享到：</a></li>
                        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
                        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-douban" href="javascript:void(0);" data-service="douban">豆瓣</a></li>
                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                <hr>
                </div>
                <!-- Duoshuo Share end-->




                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread" data-thread-key="/os/linux-user-management" data-title="Linux用户管理" data-url="http://dbaeyes.github.io/os/linux-user-management.html"></div>
                </div>
                <!-- 多说评论框 end -->
            </div>
        </div>
    </div>
</article>



<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"azeril"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- 多说公共JS代码 end -->



</script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>

  
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <!-- kill the Facebook and Weibo -->
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://twitter.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    
                    <li>
                        <a href="https://github.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <!--
                    
                    <li>
                        <a href="http://www.douban.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-douban fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    <!--
                    
                    <li>
                        <a href="https://www.facebook.com/Azeril_Lapland">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    

                    <!--
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/Azeril">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    -->

                </ul>
                <p class="copyright text-muted">
                &copy; 2011~2016 David ♪ Powered by Jekyll.
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>




<!-- Highlight.js -->
<script>
    async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js",function(){
        hljs.initHighlightingOnLoad();
    })
</script>
<link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">


</body>

</html>